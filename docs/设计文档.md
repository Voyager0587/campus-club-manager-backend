# æ ¡å›­ç¤¾å›¢ç®¡ç†ç³»ç»Ÿè®¾è®¡æ–‡æ¡£

---

# ä¸€ã€æ¦‚è¦è®¾è®¡æ–‡æ¡£

## 1. é¡¹ç›®æŠ€æœ¯é€‰å‹è¯´æ˜

### 1.1 åç«¯æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ | é€‰å‹ç†ç”± |
|------|------|------|----------|
| **Java** | 17 | ç¼–ç¨‹è¯­è¨€ | LTSç‰ˆæœ¬ã€æ€§èƒ½ä¼˜åŒ–ã€ç°ä»£è¯­æ³•ç‰¹æ€§ |
| **Maven** | 3.8+ | æ„å»ºå·¥å…· | ä¾èµ–ç®¡ç†æˆç†Ÿã€æ’ä»¶ç”Ÿæ€ä¸°å¯Œ |
| **Spring Boot** | 3.4.4 | åº”ç”¨æ¡†æ¶ | ç®€åŒ–é…ç½®ã€å¿«é€Ÿå¼€å‘ã€ç”Ÿæ€å®Œå–„ |
| **MyBatis Plus** | 3.5.9 | ORMæ¡†æ¶ | å¼ºå¤§çš„CRUDæ“ä½œã€ä»£ç ç”Ÿæˆã€åˆ†é¡µæ’ä»¶ |
| **Sa-Token** | 1.44.0 | æƒé™è®¤è¯æ¡†æ¶ | è½»é‡çº§ã€åŠŸèƒ½å®Œå–„ã€æ˜“äºé›†æˆRBAC |
| **MySQL** | 8.0+ | å…³ç³»å‹æ•°æ®åº“ | æˆç†Ÿç¨³å®šã€æ”¯æŒäº‹åŠ¡ã€é€‚åˆç»“æ„åŒ–æ•°æ® |
| **HikariCP** | 5.0+ | æ•°æ®åº“è¿æ¥æ±  | æ€§èƒ½æœ€ä¼˜ã€Spring Booté»˜è®¤é›†æˆ |
| **Logback** | 1.4+ | æ—¥å¿—æ¡†æ¶ | SLF4Jå®ç°ã€Spring Booté»˜è®¤ã€é…ç½®çµæ´» |
| **Lombok** | 1.18.30 | ä»£ç ç®€åŒ–å·¥å…· | å‡å°‘æ ·æ¿ä»£ç ã€æé«˜å¼€å‘æ•ˆç‡ |
| **Validation** | 3.0+ | å‚æ•°æ ¡éªŒ | JSR-303æ ‡å‡†ã€å£°æ˜å¼æ ¡éªŒ |
| **SpringDoc OpenAPI** | 2.3+ | APIæ–‡æ¡£ | è‡ªåŠ¨ç”ŸæˆSwaggeræ–‡æ¡£ã€æ”¯æŒåœ¨çº¿æµ‹è¯• |
| **Aliyun OSS** | 3.17+ | å¯¹è±¡å­˜å‚¨ | æ–‡ä»¶ä¸Šä¼ ã€CDNåŠ é€Ÿ |

### 1.2 æ ¸å¿ƒæ¡†æ¶é€‰å‹å¯¹æ¯”

#### Spring Boot vs å…¶ä»–æ¡†æ¶

| å¯¹æ¯”é¡¹ | Spring Boot | Spring MVC | Quarkus | Micronaut |
|--------|-------------|------------|---------|-----------|
| **é…ç½®å¤æ‚åº¦** | è‡ªåŠ¨é…ç½®ï¼Œé›¶XML | éœ€è¦å¤§é‡XMLé…ç½® | æ³¨è§£é…ç½® | æ³¨è§£é…ç½® |
| **å¯åŠ¨é€Ÿåº¦** | ä¸­ç­‰ï¼ˆ2-5ç§’ï¼‰ | æ…¢ï¼ˆ5-10ç§’ï¼‰ | å¿«ï¼ˆ<1ç§’ï¼‰ | å¿«ï¼ˆ<1ç§’ï¼‰ |
| **ç”Ÿæ€æˆç†Ÿåº¦** | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­ | â­â­â­ |
| **å­¦ä¹ æ›²çº¿** | å¹³ç¼“ | é™¡å³­ | ä¸­ç­‰ | ä¸­ç­‰ |
| **ç¤¾åŒºæ”¯æŒ** | éå¸¸æ´»è·ƒ | æ´»è·ƒ | æˆé•¿ä¸­ | æˆé•¿ä¸­ |
| **ä¼ä¸šåº”ç”¨** | å¹¿æ³›ä½¿ç”¨ | ä¼ ç»Ÿé¡¹ç›® | äº‘åŸç”Ÿåœºæ™¯ | å¾®æœåŠ¡åœºæ™¯ |

**é€‰æ‹©Spring Bootçš„åŸå› **ï¼š
- æ ¡å›­é¡¹ç›®å¯¹å¯åŠ¨é€Ÿåº¦è¦æ±‚ä¸é«˜ï¼Œæ›´çœ‹é‡å¼€å‘æ•ˆç‡
- ç”Ÿæ€æˆç†Ÿï¼Œç¬¬ä¸‰æ–¹åº“é›†æˆç®€å•ï¼ˆSa-Tokenã€MyBatis Plusç­‰ï¼‰
- å›¢é˜Ÿç†Ÿæ‚‰åº¦é«˜ï¼Œå­¦ä¹ æˆæœ¬ä½
- ç¤¾åŒºèµ„æºä¸°å¯Œï¼Œé—®é¢˜è§£å†³å¿«

#### MyBatis Plus vs å…¶ä»–ORM

| å¯¹æ¯”é¡¹ | MyBatis Plus | MyBatis | JPA/Hibernate | jOOQ |
|--------|--------------|---------|---------------|------|
| **SQLæ§åˆ¶** | çµæ´»å¯æ§ | å®Œå…¨å¯æ§ | è‡ªåŠ¨ç”Ÿæˆ | ç±»å‹å®‰å…¨SQL |
| **ä»£ç ç”Ÿæˆ** | â­â­â­â­â­ | â­â­ | â­â­â­ | â­â­â­â­ |
| **å­¦ä¹ æˆæœ¬** | ä½ | ä¸­ | é«˜ | ä¸­ |
| **å¤æ‚æŸ¥è¯¢** | æ”¯æŒè‰¯å¥½ | æœ€çµæ´» | è¾ƒå¤æ‚ | ä¼˜ç§€ |
| **æ€§èƒ½ä¼˜åŒ–** | æ˜“äºä¼˜åŒ– | æ˜“äºä¼˜åŒ– | éœ€è¦è°ƒä¼˜ | ä¼˜ç§€ |

**é€‰æ‹©MyBatis Plusçš„åŸå› **ï¼š
- ç»§æ‰¿MyBatisçš„SQLå¯æ§æ€§ï¼Œé¿å…JPAçš„N+1æŸ¥è¯¢é—®é¢˜
- å†…ç½®CRUDæ–¹æ³•ï¼Œå‡å°‘80%é‡å¤ä»£ç 
- ä»£ç ç”Ÿæˆå™¨å¿«é€Ÿæ­å»ºé¡¹ç›®éª¨æ¶
- åˆ†é¡µæ’ä»¶å¼€ç®±å³ç”¨ï¼Œæ— éœ€æ‰‹å†™åˆ†é¡µé€»è¾‘

#### Sa-Token vs å…¶ä»–è®¤è¯æ¡†æ¶

| å¯¹æ¯”é¡¹ | Sa-Token | Spring Security | Shiro | JWT |
|--------|----------|-----------------|-------|-----|
| **ä¸Šæ‰‹éš¾åº¦** | â­ç®€å• | â­â­â­â­å¤æ‚ | â­â­ä¸­ç­‰ | â­â­ä¸­ç­‰ |
| **åŠŸèƒ½å®Œæ•´æ€§** | è®¤è¯+æˆæƒ+SSO | ä¼ä¸šçº§å…¨åŠŸèƒ½ | è®¤è¯+æˆæƒ | ä»…token |
| **é…ç½®å¤æ‚åº¦** | æç®€ | å¤æ‚ | ä¸­ç­‰ | éœ€è‡ªè¡Œå®ç° |
| **æ–‡æ¡£å‹å¥½åº¦** | ä¸­æ–‡æ–‡æ¡£è¯¦ç»† | è‹±æ–‡ä¸ºä¸» | ä¸­æ–‡èµ„æºå¤š | éœ€è‡ªè¡Œè®¾è®¡ |
| **é€‚ç”¨åœºæ™¯** | ä¸­å°å‹é¡¹ç›® | å¤§å‹ä¼ä¸šåº”ç”¨ | ä¼ ç»ŸWebåº”ç”¨ | å¾®æœåŠ¡ |

**é€‰æ‹©Sa-Tokençš„åŸå› **ï¼š
- æ ¡å›­é¡¹ç›®æƒé™æ¨¡å‹ç®€å•ï¼ˆç”¨æˆ·ã€ç¤¾å›¢ç®¡ç†å‘˜ã€ç³»ç»Ÿç®¡ç†å‘˜ï¼‰
- æ³¨è§£å¼é‰´æƒï¼Œä»£ç ç®€æ´æ˜“è¯»ï¼ˆ`@SaCheckRole("admin")`ï¼‰
- ä¸­æ–‡æ–‡æ¡£å®Œå–„ï¼Œå›¢é˜Ÿå­¦ä¹ æˆæœ¬ä½
- è½»é‡çº§ï¼Œä¸éœ€è¦Spring Securityçš„å¤æ‚é…ç½®

### 1.3 æŠ€æœ¯é€‰å‹ä¼˜åŠ¿

- **å¼€å‘æ•ˆç‡é«˜**ï¼šSpring Bootè‡ªåŠ¨é…ç½® + MyBatis Plusä»£ç ç”Ÿæˆ
- **å®‰å…¨æ€§å¼º**ï¼šSa-Tokenæä¾›å®Œå–„çš„è®¤è¯æˆæƒæœºåˆ¶
- **æ˜“äºç»´æŠ¤**ï¼šåˆ†å±‚æ¶æ„æ¸…æ™°ã€ä»£ç è§„èŒƒç»Ÿä¸€
- **æ‰©å±•æ€§å¥½**ï¼šæ”¯æŒæ°´å¹³æ‰©å±•ã€æ¨¡å—åŒ–è®¾è®¡
- **æ€§èƒ½ä¼˜å¼‚**ï¼šMyBatis Plusä¼˜åŒ–æŸ¥è¯¢ã€HikariCPé«˜æ€§èƒ½è¿æ¥æ± 

## 2. é¡¹ç›®æ¶æ„å›¾

### 2.1 MVCåˆ†å±‚æ¶æ„

æœ¬é¡¹ç›®é‡‡ç”¨ç»å…¸çš„MVCä¸‰å±‚æ¶æ„æ¨¡å¼ï¼Œåˆ†ä¸ºä»¥ä¸‹å±‚æ¬¡ï¼š

**æ¶æ„å±‚æ¬¡è¯´æ˜ï¼š**

1. **Controllerå±‚ï¼ˆæ§åˆ¶å±‚ï¼‰**
   - èŒè´£ï¼šæ¥æ”¶HTTPè¯·æ±‚ï¼Œå‚æ•°æ ¡éªŒï¼Œè°ƒç”¨Serviceå±‚ï¼Œè¿”å›å“åº”
   - æŠ€æœ¯ï¼šSpring MVCã€@RestControllerã€@RequestMapping
   - ç‰¹ç‚¹ï¼šè–„æ§åˆ¶å™¨ï¼Œåªè´Ÿè´£è¯·æ±‚è½¬å‘å’Œå“åº”å°è£…

2. **Serviceå±‚ï¼ˆä¸šåŠ¡é€»è¾‘å±‚ï¼‰**
   - èŒè´£ï¼šæ ¸å¿ƒä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œäº‹åŠ¡ç®¡ç†ï¼Œæƒé™éªŒè¯
   - æŠ€æœ¯ï¼š@Serviceã€@Transactional
   - ç‰¹ç‚¹ï¼šä¸šåŠ¡é€»è¾‘é›†ä¸­ï¼Œå¯å¤ç”¨

3. **Mapperå±‚ï¼ˆæ•°æ®è®¿é—®å±‚ï¼‰**
   - èŒè´£ï¼šæ•°æ®åº“CRUDæ“ä½œï¼ŒSQLæ‰§è¡Œ
   - æŠ€æœ¯ï¼šMyBatis Plusã€BaseMapper
   - ç‰¹ç‚¹ï¼šç»§æ‰¿BaseMapperï¼Œè‡ªåŠ¨ç”Ÿæˆå¸¸ç”¨æ–¹æ³•

4. **Entityå±‚ï¼ˆå®ä½“å±‚ï¼‰**
   - èŒè´£ï¼šæ•°æ®åº“è¡¨æ˜ å°„ï¼Œæ•°æ®ä¼ è¾“
   - æŠ€æœ¯ï¼š@TableNameã€@TableId
   - ç‰¹ç‚¹ï¼šä¸æ•°æ®åº“è¡¨ä¸€ä¸€å¯¹åº”

5. **VO/DTOå±‚ï¼ˆæ•°æ®ä¼ è¾“å¯¹è±¡ï¼‰**
   - èŒè´£ï¼šå‰åç«¯æ•°æ®äº¤äº’ï¼Œæ•°æ®å°è£…
   - æŠ€æœ¯ï¼šJava Beanã€@Data
   - ç‰¹ç‚¹ï¼šéš”ç¦»å†…éƒ¨å®ä½“ï¼Œä¿æŠ¤æ•æ„Ÿä¿¡æ¯

### 2.2 ç³»ç»Ÿæ¶æ„å›¾

![whiteboard_exported_image (2)](assets/whiteboard_exported_image (2).png)



### 2.3 MVCè¯·æ±‚å¤„ç†æµç¨‹

```mermaid
sequenceDiagram
    participant Client as å®¢æˆ·ç«¯
    participant Interceptor as Sa-Tokenæ‹¦æˆªå™¨
    participant Controller as Controllerå±‚
    participant Service as Serviceå±‚
    participant Mapper as Mapperå±‚
    participant DB as MySQLæ•°æ®åº“

    Client->>Interceptor: HTTPè¯·æ±‚ + Token
    Interceptor->>Interceptor: éªŒè¯Token
    Interceptor->>Controller: æ³¨å…¥ç”¨æˆ·ä¿¡æ¯
    Controller->>Controller: å‚æ•°æ ¡éªŒ(@Valid)
    Controller->>Controller: æƒé™éªŒè¯(@SaCheckRole)
    Controller->>Service: è°ƒç”¨ä¸šåŠ¡æ–¹æ³•
    Service->>Service: ä¸šåŠ¡é€»è¾‘å¤„ç†
    Service->>Mapper: æ•°æ®åº“æ“ä½œ
    Mapper->>DB: SQLæŸ¥è¯¢
    DB-->>Mapper: è¿”å›ç»“æœ
    Mapper-->>Service: è¿”å›Entity
    Service-->>Controller: è¿”å›ä¸šåŠ¡æ•°æ®
    Controller-->>Client: ç»Ÿä¸€å“åº”Result<T>
```

## 3. æ•°æ®åº“è®¾è®¡

### 3.1 æ•°æ®åº“ERå›¾

```mermaid
erDiagram
    USER ||--o{ CLUB : "åˆ›å»º"
    USER ||--o{ CLUB_MEMBER : "åŠ å…¥"
    USER ||--o{ CLUB_APPLICATION : "ç”³è¯·"
    USER ||--o{ ACTIVITY : "åˆ›å»º"
    USER ||--o{ ACTIVITY_SIGNUP : "æŠ¥å"
    USER ||--o{ NOTIFICATION : "æ¥æ”¶"
    USER ||--o{ ANNOUNCEMENT : "å‘å¸ƒ"

    CLUB ||--o{ CLUB_MEMBER : "æ‹¥æœ‰"
    CLUB ||--o{ CLUB_APPLICATION : "æ”¶åˆ°"
    CLUB ||--o{ ACTIVITY : "ä¸¾åŠ"

    ACTIVITY ||--o{ ACTIVITY_SIGNUP : "æ¥å—"

    USER {
        bigint id PK "ç”¨æˆ·ID"
        varchar username UK "ç”¨æˆ·å"
        varchar password "å¯†ç "
        varchar real_name "çœŸå®å§“å"
        varchar student_id UK "å­¦å·"
        varchar email UK "é‚®ç®±"
        varchar phone "æ‰‹æœºå·"
        varchar avatar "å¤´åƒURL"
        varchar role "è§’è‰²"
        tinyint status "çŠ¶æ€"
        datetime create_time "åˆ›å»ºæ—¶é—´"
        datetime update_time "æ›´æ–°æ—¶é—´"
        tinyint is_deleted "åˆ é™¤æ ‡è®°"
    }

    CLUB {
        bigint id PK "ç¤¾å›¢ID"
        varchar name UK "ç¤¾å›¢åç§°"
        text description "ç¤¾å›¢ç®€ä»‹"
        varchar logo "ç¤¾å›¢å›¾æ ‡"
        varchar status "çŠ¶æ€"
        bigint create_user FK "åˆ›å»ºè€…ID"
        datetime create_time "åˆ›å»ºæ—¶é—´"
        datetime update_time "æ›´æ–°æ—¶é—´"
        tinyint is_deleted "åˆ é™¤æ ‡è®°"
    }

    CLUB_MEMBER {
        bigint id PK "æˆå‘˜å…³ç³»ID"
        bigint club_id FK "ç¤¾å›¢ID"
        bigint user_id FK "ç”¨æˆ·ID"
        varchar role "æˆå‘˜è§’è‰²"
        datetime join_time "åŠ å…¥æ—¶é—´"
        varchar memo "å¤‡æ³¨"
        datetime create_time "åˆ›å»ºæ—¶é—´"
        datetime update_time "æ›´æ–°æ—¶é—´"
        tinyint is_deleted "åˆ é™¤æ ‡è®°"
    }

    CLUB_APPLICATION {
        bigint id PK "ç”³è¯·ID"
        bigint club_id FK "ç¤¾å›¢ID"
        bigint user_id FK "ç”¨æˆ·ID"
        varchar status "ç”³è¯·çŠ¶æ€"
        text reason "ç”³è¯·ç†ç”±"
        text review_note "å®¡æ ¸å¤‡æ³¨"
        datetime review_time "å®¡æ ¸æ—¶é—´"
        bigint reviewer_id FK "å®¡æ ¸äººID"
        datetime create_time "åˆ›å»ºæ—¶é—´"
        datetime update_time "æ›´æ–°æ—¶é—´"
        tinyint is_deleted "åˆ é™¤æ ‡è®°"
    }

    ACTIVITY {
        bigint id PK "æ´»åŠ¨ID"
        bigint club_id FK "ç¤¾å›¢ID"
        varchar title "æ´»åŠ¨æ ‡é¢˜"
        text content "æ´»åŠ¨å†…å®¹"
        varchar cover "å°é¢å›¾"
        varchar location "æ´»åŠ¨åœ°ç‚¹"
        datetime start_time "å¼€å§‹æ—¶é—´"
        datetime end_time "ç»“æŸæ—¶é—´"
        datetime signup_start_time "æŠ¥åå¼€å§‹"
        datetime signup_end_time "æŠ¥åæˆªæ­¢"
        varchar status "æ´»åŠ¨çŠ¶æ€"
        int max_members "æœ€å¤§äººæ•°"
        int current_members "å½“å‰äººæ•°"
        bigint create_user FK "åˆ›å»ºè€…ID"
        datetime create_time "åˆ›å»ºæ—¶é—´"
        datetime update_time "æ›´æ–°æ—¶é—´"
        tinyint is_deleted "åˆ é™¤æ ‡è®°"
    }

    ACTIVITY_SIGNUP {
        bigint id PK "æŠ¥åID"
        bigint activity_id FK "æ´»åŠ¨ID"
        bigint user_id FK "ç”¨æˆ·ID"
        varchar status "æŠ¥åçŠ¶æ€"
        datetime signup_time "æŠ¥åæ—¶é—´"
        datetime checkin_time "ç­¾åˆ°æ—¶é—´"
        varchar remark "å¤‡æ³¨"
        datetime create_time "åˆ›å»ºæ—¶é—´"
        datetime update_time "æ›´æ–°æ—¶é—´"
        tinyint is_deleted "åˆ é™¤æ ‡è®°"
    }

    ANNOUNCEMENT {
        bigint id PK "å…¬å‘ŠID"
        varchar title "å…¬å‘Šæ ‡é¢˜"
        text content "å…¬å‘Šå†…å®¹"
        varchar type "å…¬å‘Šç±»å‹"
        bigint related_id "å…³è”ID"
        tinyint priority "ä¼˜å…ˆçº§"
        varchar status "çŠ¶æ€"
        bigint create_user_id FK "åˆ›å»ºè€…ID"
        datetime publish_time "å‘å¸ƒæ—¶é—´"
        datetime expire_time "è¿‡æœŸæ—¶é—´"
        datetime create_time "åˆ›å»ºæ—¶é—´"
        datetime update_time "æ›´æ–°æ—¶é—´"
        tinyint is_deleted "åˆ é™¤æ ‡è®°"
    }

    NOTIFICATION {
        bigint id PK "é€šçŸ¥ID"
        bigint user_id FK "ç”¨æˆ·ID"
        varchar title "é€šçŸ¥æ ‡é¢˜"
        text content "é€šçŸ¥å†…å®¹"
        varchar type "é€šçŸ¥ç±»å‹"
        varchar related_type "å…³è”ç±»å‹"
        bigint related_id "å…³è”ID"
        tinyint read_flag "é˜…è¯»æ ‡è®°"
        datetime read_time "é˜…è¯»æ—¶é—´"
        datetime create_time "åˆ›å»ºæ—¶é—´"
        datetime update_time "æ›´æ–°æ—¶é—´"
        tinyint is_deleted "åˆ é™¤æ ‡è®°"
    }
```



### 3.2 æ•°æ®åº“è¡¨è®¾è®¡

#### 3.2.1 ç”¨æˆ·è¡¨ (user)

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸NULL | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|----------|--------|------|------|
| id | bigint | - | NO | AUTO_INCREMENT | PK | ç”¨æˆ·IDï¼Œä¸»é”® |
| username | varchar | 50 | NO | - | UK | ç”¨æˆ·åï¼Œå”¯ä¸€ |
| password | varchar | 255 | NO | - | - | å¯†ç ï¼ˆåŠ å¯†å­˜å‚¨ï¼‰ |
| real_name | varchar | 50 | NO | - | - | çœŸå®å§“å |
| student_id | varchar | 50 | NO | - | UK | å­¦å·ï¼Œå”¯ä¸€ |
| email | varchar | 100 | NO | - | UK | é‚®ç®±ï¼Œå”¯ä¸€ |
| phone | varchar | 20 | YES | NULL | - | æ‰‹æœºå· |
| avatar | varchar | 500 | YES | NULL | - | å¤´åƒURL |
| role | varchar | 20 | NO | 'user' | INDEX | ç”¨æˆ·è§’è‰²ï¼šuser-æ™®é€šç”¨æˆ·, club_admin-ç¤¾å›¢ç®¡ç†å‘˜, system_admin-ç³»ç»Ÿç®¡ç†å‘˜ |
| status | tinyint | - | NO | 1 | INDEX | è´¦æˆ·çŠ¶æ€ï¼š0-ç¦ç”¨ï¼Œ1-æ­£å¸¸ |
| create_time | datetime | - | NO | CURRENT_TIMESTAMP | - | åˆ›å»ºæ—¶é—´ |
| update_time | datetime | - | NO | CURRENT_TIMESTAMP | - | æ›´æ–°æ—¶é—´ï¼ˆè‡ªåŠ¨æ›´æ–°ï¼‰ |
| is_deleted | tinyint | - | NO | 0 | - | é€»è¾‘åˆ é™¤æ ‡è®°ï¼š0-æœªåˆ é™¤ï¼Œ1-å·²åˆ é™¤ |

#### 3.2.2 ç¤¾å›¢è¡¨ (club)

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸NULL | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|----------|--------|------|------|
| id | bigint | - | NO | AUTO_INCREMENT | PK | ç¤¾å›¢IDï¼Œä¸»é”® |
| name | varchar | 100 | NO | - | UK | ç¤¾å›¢åç§°ï¼Œå”¯ä¸€ï¼ˆé…åˆis_deletedï¼‰ |
| description | text | - | YES | NULL | - | ç¤¾å›¢ç®€ä»‹ |
| logo | varchar | 500 | YES | NULL | - | ç¤¾å›¢å›¾æ ‡URL |
| status | varchar | 20 | NO | 'normal' | INDEX | ç¤¾å›¢çŠ¶æ€ï¼špending-å®¡æ ¸ä¸­, normal-æ­£å¸¸, disabled-å·²ç¦ç”¨ |
| create_user | bigint | - | NO | - | INDEX, FK | åˆ›å»ºè€…ç”¨æˆ·IDï¼Œå¤–é”®å…³è”userè¡¨ |
| create_time | datetime | - | NO | CURRENT_TIMESTAMP | INDEX | åˆ›å»ºæ—¶é—´ |
| update_time | datetime | - | NO | CURRENT_TIMESTAMP | - | æ›´æ–°æ—¶é—´ï¼ˆè‡ªåŠ¨æ›´æ–°ï¼‰ |
| is_deleted | tinyint | - | NO | 0 | - | é€»è¾‘åˆ é™¤æ ‡è®°ï¼š0-æœªåˆ é™¤ï¼Œ1-å·²åˆ é™¤ |

**å¤–é”®çº¦æŸï¼š**
- `fk_club_create_user`: create_user â†’ user(id)ï¼Œçº§è”é™åˆ¶åˆ é™¤

#### 3.2.3 ç¤¾å›¢æˆå‘˜è¡¨ (club_member)

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸NULL | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|----------|--------|------|------|
| id | bigint | - | NO | AUTO_INCREMENT | PK | æˆå‘˜å…³ç³»IDï¼Œä¸»é”® |
| club_id | bigint | - | NO | - | UK, FK | ç¤¾å›¢IDï¼Œå¤–é”®å…³è”clubè¡¨ |
| user_id | bigint | - | NO | - | UK, INDEX, FK | ç”¨æˆ·IDï¼Œå¤–é”®å…³è”userè¡¨ |
| role | varchar | 20 | NO | 'member' | INDEX | æˆå‘˜è§’è‰²ï¼šmember-æ™®é€šæˆå‘˜, leader-ç¤¾é•¿/è´Ÿè´£äºº |
| join_time | datetime | - | YES | NULL | INDEX | åŠ å…¥æ—¶é—´ |
| memo | varchar | 500 | YES | NULL | - | å¤‡æ³¨ä¿¡æ¯ |
| create_time | datetime | - | NO | CURRENT_TIMESTAMP | - | åˆ›å»ºæ—¶é—´ |
| update_time | datetime | - | NO | CURRENT_TIMESTAMP | - | æ›´æ–°æ—¶é—´ï¼ˆè‡ªåŠ¨æ›´æ–°ï¼‰ |
| is_deleted | tinyint | - | NO | 0 | - | é€»è¾‘åˆ é™¤æ ‡è®°ï¼š0-æœªåˆ é™¤ï¼Œ1-å·²åˆ é™¤ |

**å”¯ä¸€ç´¢å¼•ï¼š** `uk_club_user(club_id, user_id, is_deleted)` - é˜²æ­¢é‡å¤åŠ å…¥

**å¤–é”®çº¦æŸï¼š**
- `fk_club_member_club`: club_id â†’ club(id)ï¼Œçº§è”åˆ é™¤
- `fk_club_member_user`: user_id â†’ user(id)ï¼Œçº§è”åˆ é™¤

#### 3.2.4 ç¤¾å›¢ç”³è¯·è¡¨ (club_application)

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸NULL | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|----------|--------|------|------|
| id | bigint | - | NO | AUTO_INCREMENT | PK | ç”³è¯·IDï¼Œä¸»é”® |
| club_id | bigint | - | NO | - | INDEX, FK | ç¤¾å›¢IDï¼Œå¤–é”®å…³è”clubè¡¨ |
| user_id | bigint | - | NO | - | INDEX, FK | ç”³è¯·ç”¨æˆ·IDï¼Œå¤–é”®å…³è”userè¡¨ |
| status | varchar | 20 | NO | 'pending' | INDEX | ç”³è¯·çŠ¶æ€ï¼špending-å¾…å®¡æ ¸, approved-å·²é€šè¿‡, rejected-å·²æ‹’ç» |
| reason | text | - | YES | NULL | - | ç”³è¯·ç†ç”± |
| review_note | text | - | YES | NULL | - | å®¡æ ¸å¤‡æ³¨ï¼ˆç®¡ç†å‘˜å¡«å†™ï¼‰ |
| review_time | datetime | - | YES | NULL | - | å®¡æ ¸æ—¶é—´ |
| reviewer_id | bigint | - | YES | NULL | INDEX, FK | å®¡æ ¸äººIDï¼Œå¤–é”®å…³è”userè¡¨ |
| create_time | datetime | - | NO | CURRENT_TIMESTAMP | INDEX | åˆ›å»ºæ—¶é—´ |
| update_time | datetime | - | NO | CURRENT_TIMESTAMP | - | æ›´æ–°æ—¶é—´ï¼ˆè‡ªåŠ¨æ›´æ–°ï¼‰ |
| is_deleted | tinyint | - | NO | 0 | - | é€»è¾‘åˆ é™¤æ ‡è®°ï¼š0-æœªåˆ é™¤ï¼Œ1-å·²åˆ é™¤ |

**å¤–é”®çº¦æŸï¼š**
- `fk_club_application_club`: club_id â†’ club(id)ï¼Œçº§è”åˆ é™¤
- `fk_club_application_user`: user_id â†’ user(id)ï¼Œçº§è”åˆ é™¤
- `fk_club_application_reviewer`: reviewer_id â†’ user(id)ï¼Œåˆ é™¤æ—¶è®¾ä¸ºNULL

#### 3.2.5 æ´»åŠ¨è¡¨ (activity)

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸NULL | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|----------|--------|------|------|
| id | bigint | - | NO | AUTO_INCREMENT | PK | æ´»åŠ¨IDï¼Œä¸»é”® |
| club_id | bigint | - | NO | - | INDEX, FK | æ‰€å±ç¤¾å›¢IDï¼Œå¤–é”®å…³è”clubè¡¨ |
| title | varchar | 200 | NO | - | - | æ´»åŠ¨æ ‡é¢˜ |
| content | text | - | NO | - | - | æ´»åŠ¨å†…å®¹è¯¦æƒ… |
| cover | varchar | 500 | YES | NULL | - | æ´»åŠ¨å°é¢å›¾URL |
| location | varchar | 200 | YES | NULL | - | æ´»åŠ¨åœ°ç‚¹ |
| start_time | datetime | - | NO | - | INDEX | æ´»åŠ¨å¼€å§‹æ—¶é—´ |
| end_time | datetime | - | NO | - | INDEX | æ´»åŠ¨ç»“æŸæ—¶é—´ |
| signup_start_time | datetime | - | YES | NULL | - | æŠ¥åå¼€å§‹æ—¶é—´ |
| signup_end_time | datetime | - | YES | NULL | - | æŠ¥åæˆªæ­¢æ—¶é—´ |
| status | varchar | 20 | NO | 'draft' | INDEX | æ´»åŠ¨çŠ¶æ€ï¼šdraft-è‰ç¨¿, pending-å®¡æ ¸ä¸­, published-å·²å‘å¸ƒ, cancelled-å·²å–æ¶ˆ, completed-å·²å®Œæˆ |
| max_members | int | - | YES | NULL | - | æœ€å¤§æŠ¥åäººæ•°ï¼ˆNULLè¡¨ç¤ºä¸é™åˆ¶ï¼‰ |
| current_members | int | - | NO | 0 | - | å½“å‰æŠ¥åäººæ•°ï¼ˆå†—ä½™å­—æ®µï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½ï¼‰ |
| create_user | bigint | - | NO | - | INDEX, FK | åˆ›å»ºè€…ç”¨æˆ·IDï¼Œå¤–é”®å…³è”userè¡¨ |
| create_time | datetime | - | NO | CURRENT_TIMESTAMP | INDEX | åˆ›å»ºæ—¶é—´ |
| update_time | datetime | - | NO | CURRENT_TIMESTAMP | - | æ›´æ–°æ—¶é—´ï¼ˆè‡ªåŠ¨æ›´æ–°ï¼‰ |
| is_deleted | tinyint | - | NO | 0 | - | é€»è¾‘åˆ é™¤æ ‡è®°ï¼š0-æœªåˆ é™¤ï¼Œ1-å·²åˆ é™¤ |

**å¤–é”®çº¦æŸï¼š**
- `fk_activity_club`: club_id â†’ club(id)ï¼Œçº§è”åˆ é™¤
- `fk_activity_create_user`: create_user â†’ user(id)ï¼Œé™åˆ¶åˆ é™¤

**æ£€æŸ¥çº¦æŸï¼š**
- `chk_activity_time`: end_time >= start_timeï¼Œç¡®ä¿ç»“æŸæ—¶é—´ä¸æ—©äºå¼€å§‹æ—¶é—´

#### 3.2.6 æ´»åŠ¨æŠ¥åè¡¨ (activity_signup)

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸NULL | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|----------|--------|------|------|
| id | bigint | - | NO | AUTO_INCREMENT | PK | æŠ¥åè®°å½•IDï¼Œä¸»é”® |
| activity_id | bigint | - | NO | - | UK, FK | æ´»åŠ¨IDï¼Œå¤–é”®å…³è”activityè¡¨ |
| user_id | bigint | - | NO | - | UK, INDEX, FK | ç”¨æˆ·IDï¼Œå¤–é”®å…³è”userè¡¨ |
| status | varchar | 20 | NO | 'registered' | INDEX | æŠ¥åçŠ¶æ€ï¼šregistered-å·²æŠ¥å, cancelled-å·²å–æ¶ˆ, checked_in-å·²ç­¾åˆ°, absent-ç¼ºå¸­ |
| signup_time | datetime | - | NO | CURRENT_TIMESTAMP | INDEX | æŠ¥åæ—¶é—´ |
| checkin_time | datetime | - | YES | NULL | - | ç­¾åˆ°æ—¶é—´ |
| remark | varchar | 500 | YES | NULL | - | å¤‡æ³¨ä¿¡æ¯ |
| create_time | datetime | - | NO | CURRENT_TIMESTAMP | - | åˆ›å»ºæ—¶é—´ |
| update_time | datetime | - | NO | CURRENT_TIMESTAMP | - | æ›´æ–°æ—¶é—´ï¼ˆè‡ªåŠ¨æ›´æ–°ï¼‰ |
| is_deleted | tinyint | - | NO | 0 | - | é€»è¾‘åˆ é™¤æ ‡è®°ï¼š0-æœªåˆ é™¤ï¼Œ1-å·²åˆ é™¤ |

**å”¯ä¸€ç´¢å¼•ï¼š** `uk_activity_user(activity_id, user_id, is_deleted)` - é˜²æ­¢é‡å¤æŠ¥å

**å¤–é”®çº¦æŸï¼š**
- `fk_activity_signup_activity`: activity_id â†’ activity(id)ï¼Œçº§è”åˆ é™¤
- `fk_activity_signup_user`: user_id â†’ user(id)ï¼Œçº§è”åˆ é™¤

#### 3.2.7 å…¬å‘Šè¡¨ (announcement)

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸NULL | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|----------|--------|------|------|
| id | bigint | - | NO | AUTO_INCREMENT | PK | å…¬å‘ŠIDï¼Œä¸»é”® |
| title | varchar | 200 | NO | - | - | å…¬å‘Šæ ‡é¢˜ |
| content | text | - | NO | - | - | å…¬å‘Šå†…å®¹ |
| type | varchar | 20 | NO | 'system' | INDEX | å…¬å‘Šç±»å‹ï¼šsystem-ç³»ç»Ÿå…¬å‘Š, club-ç¤¾å›¢å…¬å‘Š, activity-æ´»åŠ¨å…¬å‘Š |
| related_id | bigint | - | YES | NULL | INDEX | å…³è”IDï¼ˆç¤¾å›¢IDæˆ–æ´»åŠ¨IDï¼Œæ ¹æ®typeç±»å‹å…³è”ï¼‰ |
| priority | tinyint | - | NO | 0 | INDEX | ä¼˜å…ˆçº§ï¼š0-æ™®é€š, 1-é‡è¦, 2-ç´§æ€¥ |
| status | varchar | 20 | NO | 'published' | INDEX | çŠ¶æ€ï¼šdraft-è‰ç¨¿, published-å·²å‘å¸ƒ, archived-å·²å½’æ¡£ |
| create_user_id | bigint | - | NO | - | INDEX, FK | åˆ›å»ºè€…ç”¨æˆ·IDï¼Œå¤–é”®å…³è”userè¡¨ |
| publish_time | datetime | - | YES | NULL | INDEX | å‘å¸ƒæ—¶é—´ |
| expire_time | datetime | - | YES | NULL | - | è¿‡æœŸæ—¶é—´ |
| create_time | datetime | - | NO | CURRENT_TIMESTAMP | - | åˆ›å»ºæ—¶é—´ |
| update_time | datetime | - | NO | CURRENT_TIMESTAMP | - | æ›´æ–°æ—¶é—´ï¼ˆè‡ªåŠ¨æ›´æ–°ï¼‰ |
| is_deleted | tinyint | - | NO | 0 | - | é€»è¾‘åˆ é™¤æ ‡è®°ï¼š0-æœªåˆ é™¤ï¼Œ1-å·²åˆ é™¤ |

**å¤–é”®çº¦æŸï¼š**
- `fk_announcement_create_user`: create_user_id â†’ user(id)ï¼Œé™åˆ¶åˆ é™¤

#### 3.2.8 é€šçŸ¥è¡¨ (notification)

| å­—æ®µå | ç±»å‹ | é•¿åº¦ | å…è®¸NULL | é»˜è®¤å€¼ | ç´¢å¼• | è¯´æ˜ |
|--------|------|------|----------|--------|------|------|
| id | bigint | - | NO | AUTO_INCREMENT | PK | é€šçŸ¥IDï¼Œä¸»é”® |
| user_id | bigint | - | NO | - | INDEX, FK | æ¥æ”¶ç”¨æˆ·IDï¼Œå¤–é”®å…³è”userè¡¨ |
| title | varchar | 200 | NO | - | - | é€šçŸ¥æ ‡é¢˜ |
| content | text | - | NO | - | - | é€šçŸ¥å†…å®¹ |
| type | varchar | 20 | NO | - | INDEX | é€šçŸ¥ç±»å‹ï¼šsystem-ç³»ç»Ÿé€šçŸ¥, audit-å®¡æ ¸æ¶ˆæ¯, activity-æ´»åŠ¨æé†’, club-ç¤¾å›¢é€šçŸ¥ |
| related_type | varchar | 20 | YES | NULL | INDEX | å…³è”ç±»å‹ï¼šclub, activity, announcementç­‰ |
| related_id | bigint | - | YES | NULL | INDEX | å…³è”ID |
| read_flag | tinyint | - | NO | 0 | INDEX | é˜…è¯»æ ‡è®°ï¼š0-æœªè¯», 1-å·²è¯» |
| read_time | datetime | - | YES | NULL | - | é˜…è¯»æ—¶é—´ |
| create_time | datetime | - | NO | CURRENT_TIMESTAMP | INDEX | åˆ›å»ºæ—¶é—´ |
| update_time | datetime | - | NO | CURRENT_TIMESTAMP | - | æ›´æ–°æ—¶é—´ï¼ˆè‡ªåŠ¨æ›´æ–°ï¼‰ |
| is_deleted | tinyint | - | NO | 0 | - | é€»è¾‘åˆ é™¤æ ‡è®°ï¼š0-æœªåˆ é™¤ï¼Œ1-å·²åˆ é™¤ |

**å¤åˆç´¢å¼•ï¼š** `idx_related(related_type, related_id)` - ä¼˜åŒ–å…³è”æŸ¥è¯¢

**å¤–é”®çº¦æŸï¼š**
- `fk_notification_user`: user_id â†’ user(id)ï¼Œçº§è”åˆ é™¤

### 3.3 æ•°æ®åº“è®¾è®¡è¯´æ˜

#### 3.3.1 è®¾è®¡åŸåˆ™

1. **é€»è¾‘åˆ é™¤**ï¼šæ‰€æœ‰è¡¨é‡‡ç”¨é€»è¾‘åˆ é™¤ï¼ˆis_deletedå­—æ®µï¼‰ï¼Œä¿ç•™å†å²æ•°æ®ä¾¿äºå®¡è®¡å’Œæ¢å¤
2. **æ—¶é—´æˆ³**ï¼šç»Ÿä¸€ä½¿ç”¨create_timeå’Œupdate_timeå­—æ®µï¼Œupdate_timeè‡ªåŠ¨æ›´æ–°
3. **å¤–é”®çº¦æŸ**ï¼šåˆç†ä½¿ç”¨å¤–é”®ä¿è¯æ•°æ®å®Œæ•´æ€§ï¼Œæ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©çº§è”ç­–ç•¥
4. **ç´¢å¼•ä¼˜åŒ–**ï¼šä¸ºå¸¸ç”¨æŸ¥è¯¢å­—æ®µå»ºç«‹ç´¢å¼•ï¼Œæé«˜æŸ¥è¯¢æ€§èƒ½
5. **å­—ç¬¦é›†**ï¼šä½¿ç”¨utf8mb4å­—ç¬¦é›†ï¼Œæ”¯æŒemojiç­‰ç‰¹æ®Šå­—ç¬¦
6. **å‘½åè§„èŒƒ**ï¼šè¡¨åã€å­—æ®µåä½¿ç”¨å°å†™ä¸‹åˆ’çº¿å‘½åæ³•

#### 3.3.2 æ€§èƒ½ä¼˜åŒ–è®¾è®¡

1. **å†—ä½™å­—æ®µ**ï¼šactivityè¡¨çš„current_memberså­—æ®µå†—ä½™å­˜å‚¨ï¼Œå‡å°‘å…³è”æŸ¥è¯¢
2. **å¤åˆç´¢å¼•**ï¼šä¸ºå¸¸è§ç»„åˆæŸ¥è¯¢å»ºç«‹å¤åˆç´¢å¼•ï¼ˆå¦‚uk_club_userã€idx_relatedï¼‰
3. **åˆ†é¡µæŸ¥è¯¢**ï¼šé€šè¿‡create_timeç­‰æ—¶é—´å­—æ®µç´¢å¼•æ”¯æŒé«˜æ•ˆåˆ†é¡µ
4. **çŠ¶æ€ç´¢å¼•**ï¼šä¸ºstatusç­‰æšä¸¾å­—æ®µå»ºç«‹ç´¢å¼•ï¼Œä¼˜åŒ–çŠ¶æ€ç­›é€‰æŸ¥è¯¢

#### 3.3.3 æ•°æ®å®Œæ•´æ€§ä¿è¯

1. **å”¯ä¸€çº¦æŸ**ï¼šç”¨æˆ·åã€å­¦å·ã€é‚®ç®±ç­‰å…³é”®å­—æ®µè®¾ç½®å”¯ä¸€ç´¢å¼•
2. **æ£€æŸ¥çº¦æŸ**ï¼šæ´»åŠ¨è¡¨çš„æ—¶é—´æ£€æŸ¥çº¦æŸç¡®ä¿æ—¶é—´é€»è¾‘æ­£ç¡®
3. **å¤–é”®çº§è”**ï¼šåˆç†è®¾ç½®çº§è”åˆ é™¤å’Œé™åˆ¶åˆ é™¤ï¼Œé˜²æ­¢æ•°æ®å­¤å²›
4. **é»˜è®¤å€¼**ï¼šä¸ºçŠ¶æ€å­—æ®µè®¾ç½®åˆç†é»˜è®¤å€¼ï¼Œç®€åŒ–ä¸šåŠ¡é€»è¾‘

## 4. ç³»ç»Ÿéƒ¨ç½²æ¶æ„

### ğŸŒŸğŸŒŸğŸŒŸ4.1 éƒ¨ç½²æ¶æ„å›¾

> éƒ¨ç½²å›¾è¯´æ˜ï¼šæ¸…æ™°è¡¨è¾¾å‰åç«¯éƒ¨ç½²ä½ç½®ï¼ˆæœ¬åœ°ã€äº‘æœåŠ¡å™¨æˆ–æ··åˆï¼‰







### 4.2 éƒ¨ç½²ç¯å¢ƒè¯´æ˜

| ç¯å¢ƒ | é…ç½® | è¯´æ˜ |
|------|------|------|
| **å¼€å‘ç¯å¢ƒ** | å•æœºéƒ¨ç½² | æœ¬åœ°å¼€å‘æµ‹è¯• |
| **æµ‹è¯•ç¯å¢ƒ** | 2å°åº”ç”¨æœåŠ¡å™¨ + 1å°æ•°æ®åº“ | åŠŸèƒ½æµ‹è¯•ã€æ€§èƒ½æµ‹è¯• |
| **ç”Ÿäº§ç¯å¢ƒ** | 3å°åº”ç”¨æœåŠ¡å™¨ + MySQLä¸»ä» + Redisé›†ç¾¤ | é«˜å¯ç”¨éƒ¨ç½² |

### 4.3 éƒ¨ç½²ä½ç½®è¯´æ˜

**å‰åç«¯éƒ¨ç½²ä½ç½®ï¼š**
- **å‰ç«¯åº”ç”¨**ï¼šéƒ¨ç½²åœ¨NginxæœåŠ¡å™¨ï¼Œæä¾›é™æ€èµ„æºæœåŠ¡
- **åç«¯åº”ç”¨**ï¼šéƒ¨ç½²åœ¨åº”ç”¨æœåŠ¡å™¨é›†ç¾¤ï¼ˆäº‘æœåŠ¡å™¨ï¼‰ï¼Œé€šè¿‡Nginxåå‘ä»£ç†è®¿é—®
- **æ•°æ®åº“**ï¼šç‹¬ç«‹æ•°æ®åº“æœåŠ¡å™¨ï¼ˆäº‘æœåŠ¡å™¨ï¼‰ï¼Œä¸»ä»æ¶æ„ä¿è¯é«˜å¯ç”¨
- **æ–‡ä»¶å­˜å‚¨**ï¼šé˜¿é‡Œäº‘OSSäº‘å­˜å‚¨æœåŠ¡
- **ç¼“å­˜æœåŠ¡**ï¼šRedisé›†ç¾¤ï¼ˆäº‘æœåŠ¡å™¨ï¼‰

---

# äºŒã€è¯¦ç»†è®¾è®¡æ–‡æ¡£

## 1. ç³»ç»Ÿç±»å›¾

> ç³»ç»Ÿç±»å›¾å¿…é¡»ä¸å®é™…ä»£ç ç±»åå®Œå…¨ä¸€è‡´ï¼Œä½¿ç”¨è‹±æ–‡å‘½å
>
> ç±»å›¾æ¶µç›–æ§åˆ¶å™¨ã€æœåŠ¡å±‚ã€DAOå±‚åŠå®ä½“ç±»ï¼Œç¡®ä¿å¯æŒ‡å¯¼ç¼–ç 

```mermaid
classDiagram
    %% ==================== Controllerå±‚ ====================
    class UserController {
        -UserService userService
        +register(RegisterRequest) Result~Void~
        +login(LoginRequest) Result~LoginResponse~
        +getCurrentUserInfo() Result~UserInfoVO~
        +updateUserInfo(UpdateUserRequest) Result~Void~
    }

    class ClubController {
        -ClubService clubService
        +listClubs(pageNum, pageSize, keyword) Result~Page~ClubVO~~
        +getClubDetail(clubId) Result~ClubDetailVO~
        +getMyClubs() Result~List~ClubVO~~
        +applyJoinClub(ApplyJoinClubRequest) Result~Void~
        +getMyApplications() Result~List~ClubApplicationVO~~
    }

    class ClubManagementController {
        -ClubService clubService
        +getClubPendingApplications(clubId, pageNum, pageSize) Result~Page~ClubApplicationVO~~
        +reviewApplicationByLeader(clubId, ReviewApplicationRequest) Result~Void~
        +updateClubByLeader(clubId, UpdateClubRequest) Result~Void~
    }

    class AdminClubController {
        -ClubService clubService
        +createClub(CreateClubRequest) Result~Void~
        +updateClub(UpdateClubRequest) Result~Void~
        +deleteClub(clubId) Result~Void~
        +setClubLeader(clubId, userId) Result~Void~
        +removeClubLeader(clubId, userId) Result~Void~
    }

    class ActivityController {
        -ActivityService activityService
        +listActivities(pageNum, pageSize, keyword, clubId) Result~Page~ActivityVO~~
        +getActivityDetail(activityId) Result~ActivityDetailVO~
        +signupActivity(activityId) Result~Void~
        +cancelSignup(activityId) Result~Void~
        +getMySignups() Result~List~ActivitySignupVO~~
    }

    class ClubActivityController {
        -ActivityService activityService
        +createActivity(CreateActivityRequest) Result~Void~
        +updateActivity(activityId, UpdateActivityRequest) Result~Void~
        +cancelActivity(activityId) Result~Void~
        +getActivitySignups(activityId, pageNum, pageSize) Result~Page~ActivitySignupVO~~
        +checkinActivity(activityId, CheckinRequest) Result~Void~
    }

    class AdminActivityController {
        -ActivityService activityService
        +getAllActivities(pageNum, pageSize, keyword, status) Result~Page~ActivityVO~~
        +reviewActivity(activityId, ReviewActivityRequest) Result~Void~
        +deleteActivity(activityId) Result~Void~
    }

    %% ==================== Serviceå±‚ ====================
    class UserService {
        <<interface>>
        +register(RegisterRequest) void
        +login(LoginRequest) LoginResponse
        +getCurrentUserInfo() UserInfoVO
        +updateUserInfo(UpdateUserRequest) void
    }

    class ClubService {
        <<interface>>
        +createClub(CreateClubRequest) void
        +updateClub(UpdateClubRequest) void
        +deleteClub(clubId) void
        +reviewApplication(ReviewApplicationRequest) void
        +listClubs(pageNum, pageSize, keyword) Page~ClubVO~
        +getClubDetail(clubId) ClubDetailVO
        +getMyClubs() List~ClubVO~
        +applyJoinClub(ApplyJoinClubRequest) void
        +getClubMembers(clubId, pageNum, pageSize) Page~ClubMemberVO~
        +setClubLeader(clubId, userId) void
        +reviewApplicationByLeader(clubId, ReviewApplicationRequest) void
        +updateClubByLeader(clubId, UpdateClubRequest) void
    }

    class ActivityService {
        <<interface>>
        +createActivity(CreateActivityRequest) void
        +updateActivity(activityId, UpdateActivityRequest) void
        +cancelActivity(activityId) void
        +getActivitySignups(activityId, pageNum, pageSize) Page~ActivitySignupVO~
        +checkinActivity(activityId, CheckinRequest) void
        +getAllActivities(pageNum, pageSize, keyword, status) Page~ActivityVO~
        +reviewActivity(activityId, ReviewActivityRequest) void
        +deleteActivity(activityId) void
        +listActivities(pageNum, pageSize, keyword, clubId) Page~ActivityVO~
        +getActivityDetail(activityId) ActivityDetailVO
        +signupActivity(activityId) void
        +cancelSignup(activityId) void
        +getMySignups() List~ActivitySignupVO~
    }

    %% ==================== Mapperå±‚ ====================
    class UserMapper {
        <<interface>>
        <<BaseMapper~User~>>
    }

    class ClubMapper {
        <<interface>>
        <<BaseMapper~Club~>>
    }

    class ClubMemberMapper {
        <<interface>>
        <<BaseMapper~ClubMember~>>
    }

    class ClubApplicationMapper {
        <<interface>>
        <<BaseMapper~ClubApplication~>>
    }

    class ActivityMapper {
        <<interface>>
        <<BaseMapper~Activity~>>
    }

    class ActivitySignupMapper {
        <<interface>>
        <<BaseMapper~ActivitySignup~>>
    }

    %% ==================== Entityå±‚ ====================
    class User {
        -Long id
        -String username
        -String password
        -String realName
        -String studentId
        -String email
        -String phone
        -String avatar
        -UserRole role
        -Integer status
        -LocalDateTime createTime
        -LocalDateTime updateTime
        -Integer isDeleted
    }

    class Club {
        -Long id
        -String name
        -String description
        -String logo
        -ClubStatus status
        -Long createUser
        -LocalDateTime createTime
        -LocalDateTime updateTime
        -Integer isDeleted
    }

    class ClubMember {
        -Long id
        -Long clubId
        -Long userId
        -String role
        -LocalDateTime joinTime
        -String memo
        -LocalDateTime createTime
        -LocalDateTime updateTime
        -Integer isDeleted
    }

    class ClubApplication {
        -Long id
        -Long clubId
        -Long userId
        -String status
        -String reason
        -String reviewNote
        -LocalDateTime reviewTime
        -Long reviewerId
        -LocalDateTime createTime
        -LocalDateTime updateTime
        -Integer isDeleted
    }

    class Activity {
        -Long id
        -Long clubId
        -String title
        -String content
        -String cover
        -String location
        -LocalDateTime startTime
        -LocalDateTime endTime
        -LocalDateTime signupStartTime
        -LocalDateTime signupEndTime
        -ActivityStatus status
        -Integer maxMembers
        -Integer currentMembers
        -Long createUser
        -LocalDateTime createTime
        -LocalDateTime updateTime
        -Integer isDeleted
    }

    class ActivitySignup {
        -Long id
        -Long activityId
        -Long userId
        -String status
        -LocalDateTime signupTime
        -LocalDateTime checkinTime
        -String remark
        -LocalDateTime createTime
        -LocalDateTime updateTime
        -Integer isDeleted
    }

    %% ==================== å…³ç³»å®šä¹‰ ====================
    UserController --> UserService : ä¾èµ–
    ClubController --> ClubService : ä¾èµ–
    ClubManagementController --> ClubService : ä¾èµ–
    AdminClubController --> ClubService : ä¾èµ–
    ActivityController --> ActivityService : ä¾èµ–
    ClubActivityController --> ActivityService : ä¾èµ–
    AdminActivityController --> ActivityService : ä¾èµ–

    UserService --> UserMapper : ä¾èµ–
    ClubService --> ClubMapper : ä¾èµ–
    ClubService --> ClubMemberMapper : ä¾èµ–
    ClubService --> ClubApplicationMapper : ä¾èµ–
    ActivityService --> ActivityMapper : ä¾èµ–
    ActivityService --> ActivitySignupMapper : ä¾èµ–

    UserMapper --> User : æ“ä½œ
    ClubMapper --> Club : æ“ä½œ
    ClubMemberMapper --> ClubMember : æ“ä½œ
    ClubApplicationMapper --> ClubApplication : æ“ä½œ
    ActivityMapper --> Activity : æ“ä½œ
    ActivitySignupMapper --> ActivitySignup : æ“ä½œ
```

## 2. æ¥å£è®¾è®¡

### 2.1 ç”¨æˆ·ç®¡ç†æ¨¡å—

**æ§åˆ¶å™¨**: `UserController`  
**åŸºç¡€è·¯å¾„**: `/user`  
**åŠŸèƒ½æè¿°**: æä¾›ç”¨æˆ·æ³¨å†Œã€ç™»å½•ã€ä¿¡æ¯æŸ¥è¯¢å’Œæ›´æ–°ç­‰åŸºç¡€åŠŸèƒ½

#### 2.1.1 ç”¨æˆ·æ³¨å†Œ
- **æ¥å£è·¯å¾„**: `POST /user/register`
- **æƒé™è¦æ±‚**: å…¬å¼€æ¥å£ï¼ˆæ— éœ€ç™»å½•ï¼‰
- **åŠŸèƒ½è¯´æ˜**: ç”¨æˆ·è‡ªåŠ©æ³¨å†Œè´¦å·
- **è¯·æ±‚ä½“**: `RegisterRequest`
- **å“åº”**: æ³¨å†ŒæˆåŠŸæç¤º


#### 2.1.2 ç”¨æˆ·ç™»å½•
- **æ¥å£è·¯å¾„**: `POST /user/login`
- **æƒé™è¦æ±‚**: å…¬å¼€æ¥å£ï¼ˆæ— éœ€ç™»å½•ï¼‰
- **åŠŸèƒ½è¯´æ˜**: ç”¨æˆ·ç™»å½•è·å–Token
- **è¯·æ±‚ä½“**: `LoginRequest`
- **å“åº”**: `LoginResponse`ï¼ˆåŒ…å«Tokenå’Œç”¨æˆ·ä¿¡æ¯ï¼‰

#### 2.1.3 è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- **æ¥å£è·¯å¾„**: `GET /user/info`
- **æƒé™è¦æ±‚**: éœ€è¦ç™»å½•ï¼ˆ`@SaCheckRole("user")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: è·å–å½“å‰ç™»å½•ç”¨æˆ·çš„è¯¦ç»†ä¿¡æ¯
- **å“åº”**: `UserInfoVO`

#### 2.1.4 æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- **æ¥å£è·¯å¾„**: `POST /user/update`
- **æƒé™è¦æ±‚**: éœ€è¦ç™»å½•ï¼ˆ`@SaCheckRole("user")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: æ›´æ–°å½“å‰ç”¨æˆ·çš„ä¸ªäººèµ„æ–™
- **è¯·æ±‚ä½“**: `UpdateUserRequest`
- **å“åº”**: æ›´æ–°æˆåŠŸæç¤º

---

### 2.2 ç¤¾å›¢ç®¡ç†æ¨¡å—

#### 2.2.1 ç”¨æˆ·ç«¯æ¥å£

**æ§åˆ¶å™¨**: `ClubController`  
**åŸºç¡€è·¯å¾„**: `/club`  
**åŠŸèƒ½æè¿°**: æä¾›ç¤¾å›¢æµè§ˆã€æŸ¥è¯¢ã€ç”³è¯·åŠ å…¥ç­‰ç”¨æˆ·ç«¯åŠŸèƒ½

##### 2.2.1.1 åˆ†é¡µæŸ¥è¯¢ç¤¾å›¢åˆ—è¡¨
- **æ¥å£è·¯å¾„**: `GET /club/list`
- **æƒé™è¦æ±‚**: å…¬å¼€æ¥å£ï¼ˆæ— éœ€ç™»å½•ï¼‰
- **åŠŸèƒ½è¯´æ˜**: æ”¯æŒå…³é”®è¯æœç´¢çš„åˆ†é¡µç¤¾å›¢åˆ—è¡¨æŸ¥è¯¢
- **è¯·æ±‚å‚æ•°**:
  - `pageNum` (Integer, é»˜è®¤å€¼: 1): é¡µç 
  - `pageSize` (Integer, é»˜è®¤å€¼: 10): æ¯é¡µæ•°é‡
  - `keyword` (String, å¯é€‰): æœç´¢å…³é”®è¯
- **å“åº”**: `Page<ClubVO>`

##### 2.2.1.2 æŸ¥è¯¢ç¤¾å›¢è¯¦æƒ…
- **æ¥å£è·¯å¾„**: `GET /club/{id}`
- **æƒé™è¦æ±‚**: å…¬å¼€æ¥å£ï¼ˆæ— éœ€ç™»å½•ï¼‰
- **åŠŸèƒ½è¯´æ˜**: æŸ¥çœ‹ç¤¾å›¢è¯¦ç»†ä¿¡æ¯
- **è·¯å¾„å‚æ•°**: `id` (Long): ç¤¾å›¢ID
- **å“åº”**: `ClubDetailVO`

##### 2.2.1.3 æŸ¥è¯¢æˆ‘åŠ å…¥çš„ç¤¾å›¢
- **æ¥å£è·¯å¾„**: `GET /club/my`
- **æƒé™è¦æ±‚**: éœ€è¦ç™»å½•ï¼ˆ`@SaCheckRole("user")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: æŸ¥çœ‹å½“å‰ç”¨æˆ·å·²åŠ å…¥çš„ç¤¾å›¢åˆ—è¡¨
- **å“åº”**: `List<ClubVO>`

##### 2.2.1.4 ç”³è¯·åŠ å…¥ç¤¾å›¢
- **æ¥å£è·¯å¾„**: `POST /club/apply`
- **æƒé™è¦æ±‚**: éœ€è¦ç™»å½•ï¼ˆ`@SaCheckRole("user")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: æäº¤åŠ å…¥ç¤¾å›¢çš„ç”³è¯·
- **è¯·æ±‚ä½“**: `ApplyJoinClubRequest`
- **å“åº”**: ç”³è¯·æäº¤æˆåŠŸæç¤º

##### 2.2.1.5 æŸ¥è¯¢ç¤¾å›¢æˆå‘˜åˆ—è¡¨
- **æ¥å£è·¯å¾„**: `GET /club/{id}/members`
- **æƒé™è¦æ±‚**: å…¬å¼€æ¥å£ï¼ˆæ— éœ€ç™»å½•ï¼‰
- **åŠŸèƒ½è¯´æ˜**: æŸ¥çœ‹ç¤¾å›¢çš„æˆå‘˜åˆ—è¡¨
- **è·¯å¾„å‚æ•°**: `id` (Long): ç¤¾å›¢ID
- **è¯·æ±‚å‚æ•°**:
  - `pageNum` (Integer, é»˜è®¤å€¼: 1): é¡µç 
  - `pageSize` (Integer, é»˜è®¤å€¼: 10): æ¯é¡µæ•°é‡
- **å“åº”**: `Page<ClubMemberVO>`

##### 2.2.1.6 æŸ¥è¯¢æˆ‘çš„ç”³è¯·è®°å½•
- **æ¥å£è·¯å¾„**: `GET /club/my/applications`
- **æƒé™è¦æ±‚**: éœ€è¦ç™»å½•ï¼ˆ`@SaCheckRole("user")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„æ‰€æœ‰ç¤¾å›¢ç”³è¯·è®°å½•
- **å“åº”**: `List<ClubApplicationVO>`

#### 2.2.2 ç¤¾å›¢è´Ÿè´£äººæ¥å£

**æ§åˆ¶å™¨**: `ClubManagementController`  
**åŸºç¡€è·¯å¾„**: `/club/management`  
**åŠŸèƒ½æè¿°**: æä¾›ç¤¾å›¢è´Ÿè´£äººç®¡ç†ç¤¾å›¢çš„ç›¸å…³åŠŸèƒ½

##### 2.2.2.1 æŸ¥è¯¢å¾…å®¡æ ¸ç”³è¯·åˆ—è¡¨
- **æ¥å£è·¯å¾„**: `GET /club/management/{clubId}/applications/pending`
- **æƒé™è¦æ±‚**: éœ€è¦ç™»å½•ï¼ˆ`@SaCheckLogin`ï¼‰ï¼Œä¸”éœ€è¦ç¤¾å›¢è´Ÿè´£äººæƒé™
- **åŠŸèƒ½è¯´æ˜**: æŸ¥çœ‹è‡ªå·±ç®¡ç†çš„ç¤¾å›¢çš„å¾…å®¡æ ¸ç”³è¯·
- **è·¯å¾„å‚æ•°**: `clubId` (Long): ç¤¾å›¢ID
- **è¯·æ±‚å‚æ•°**:
  - `pageNum` (Integer, é»˜è®¤å€¼: 1): é¡µç 
  - `pageSize` (Integer, é»˜è®¤å€¼: 10): æ¯é¡µæ•°é‡
- **å“åº”**: `Page<ClubApplicationVO>`

##### 2.2.2.2 å®¡æ ¸ç¤¾å›¢ç”³è¯·
- **æ¥å£è·¯å¾„**: `POST /club/management/{clubId}/applications/review`
- **æƒé™è¦æ±‚**: éœ€è¦ç™»å½•ï¼ˆ`@SaCheckLogin`ï¼‰ï¼Œä¸”éœ€è¦ç¤¾å›¢è´Ÿè´£äººæƒé™
- **åŠŸèƒ½è¯´æ˜**: å®¡æ ¸é€šè¿‡æˆ–æ‹’ç»ç”¨æˆ·çš„åŠ å…¥ç”³è¯·
- **è·¯å¾„å‚æ•°**: `clubId` (Long): ç¤¾å›¢ID
- **è¯·æ±‚ä½“**: `ReviewApplicationRequest`
- **å“åº”**: å®¡æ ¸å®Œæˆæç¤º

##### 2.2.2.3 æ›´æ–°ç¤¾å›¢ä¿¡æ¯
- **æ¥å£è·¯å¾„**: `PUT /club/management/{clubId}`
- **æƒé™è¦æ±‚**: éœ€è¦ç™»å½•ï¼ˆ`@SaCheckLogin`ï¼‰ï¼Œä¸”éœ€è¦ç¤¾å›¢è´Ÿè´£äººæƒé™
- **åŠŸèƒ½è¯´æ˜**: ä¿®æ”¹è‡ªå·±ç®¡ç†çš„ç¤¾å›¢çš„åŸºæœ¬ä¿¡æ¯
- **è·¯å¾„å‚æ•°**: `clubId` (Long): ç¤¾å›¢ID
- **è¯·æ±‚ä½“**: `UpdateClubRequest`
- **å“åº”**: æ›´æ–°æˆåŠŸæç¤º

#### 2.2.3 ç³»ç»Ÿç®¡ç†å‘˜æ¥å£

**æ§åˆ¶å™¨**: `AdminClubController`  
**åŸºç¡€è·¯å¾„**: `/admin/club`  
**åŠŸèƒ½æè¿°**: æä¾›ç³»ç»Ÿç®¡ç†å‘˜å¯¹ç¤¾å›¢çš„åˆ›å»ºã€å®¡æ ¸ã€ç®¡ç†ç­‰å®Œæ•´åŠŸèƒ½

##### 2.2.3.1 åˆ›å»ºç¤¾å›¢
- **æ¥å£è·¯å¾„**: `POST /admin/club/create`
- **æƒé™è¦æ±‚**: éœ€è¦ç³»ç»Ÿç®¡ç†å‘˜è§’è‰²ï¼ˆ`@SaCheckRole("system_admin")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: åˆ›å»ºæ–°çš„ç¤¾å›¢
- **è¯·æ±‚ä½“**: `CreateClubRequest`
- **å“åº”**: ç¤¾å›¢åˆ›å»ºæˆåŠŸæç¤º

##### 2.2.3.2 æ›´æ–°ç¤¾å›¢ä¿¡æ¯
- **æ¥å£è·¯å¾„**: `PUT /admin/club/update`
- **æƒé™è¦æ±‚**: éœ€è¦ç³»ç»Ÿç®¡ç†å‘˜è§’è‰²ï¼ˆ`@SaCheckRole("system_admin")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: ä¿®æ”¹ç¤¾å›¢åŸºæœ¬ä¿¡æ¯
- **è¯·æ±‚ä½“**: `UpdateClubRequest`
- **å“åº”**: æ›´æ–°æˆåŠŸæç¤º

##### 2.2.3.3 åˆ é™¤ç¤¾å›¢
- **æ¥å£è·¯å¾„**: `DELETE /admin/club/{id}`
- **æƒé™è¦æ±‚**: éœ€è¦ç³»ç»Ÿç®¡ç†å‘˜è§’è‰²ï¼ˆ`@SaCheckRole("system_admin")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: åˆ é™¤ç¤¾å›¢åŠç›¸å…³æ•°æ®
- **è·¯å¾„å‚æ•°**: `id` (Long): ç¤¾å›¢ID
- **å“åº”**: åˆ é™¤æˆåŠŸæç¤º

##### 2.2.3.4 æŸ¥è¯¢å¾…å®¡æ ¸ç”³è¯·åˆ—è¡¨
- **æ¥å£è·¯å¾„**: `GET /admin/club/applications/pending`
- **æƒé™è¦æ±‚**: éœ€è¦ç³»ç»Ÿç®¡ç†å‘˜è§’è‰²ï¼ˆ`@SaCheckRole("system_admin")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: æŸ¥çœ‹æ‰€æœ‰å¾…å®¡æ ¸çš„ç¤¾å›¢åŠ å…¥ç”³è¯·
- **è¯·æ±‚å‚æ•°**:
  - `pageNum` (Integer, é»˜è®¤å€¼: 1): é¡µç 
  - `pageSize` (Integer, é»˜è®¤å€¼: 10): æ¯é¡µæ•°é‡
- **å“åº”**: `Page<ClubApplicationVO>`

##### 2.2.3.5 å®¡æ ¸ç¤¾å›¢ç”³è¯·
- **æ¥å£è·¯å¾„**: `POST /admin/club/applications/review`
- **æƒé™è¦æ±‚**: éœ€è¦ç³»ç»Ÿç®¡ç†å‘˜è§’è‰²ï¼ˆ`@SaCheckRole("system_admin")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: å®¡æ ¸é€šè¿‡æˆ–æ‹’ç»ç”¨æˆ·çš„åŠ å…¥ç”³è¯·
- **è¯·æ±‚ä½“**: `ReviewApplicationRequest`
- **å“åº”**: å®¡æ ¸å®Œæˆæç¤º

##### 2.2.3.6 è®¾ç½®ç¤¾å›¢è´Ÿè´£äºº
- **æ¥å£è·¯å¾„**: `POST /admin/club/{clubId}/leader/{userId}`
- **æƒé™è¦æ±‚**: éœ€è¦ç³»ç»Ÿç®¡ç†å‘˜è§’è‰²ï¼ˆ`@SaCheckRole("system_admin")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: å°†æŒ‡å®šç”¨æˆ·è®¾ç½®ä¸ºç¤¾å›¢è´Ÿè´£äºº
- **è·¯å¾„å‚æ•°**:
  - `clubId` (Long): ç¤¾å›¢ID
  - `userId` (Long): ç”¨æˆ·ID
- **å“åº”**: è®¾ç½®æˆåŠŸæç¤º

##### 2.2.3.7 å–æ¶ˆç¤¾å›¢è´Ÿè´£äºº
- **æ¥å£è·¯å¾„**: `DELETE /admin/club/{clubId}/leader/{userId}`
- **æƒé™è¦æ±‚**: éœ€è¦ç³»ç»Ÿç®¡ç†å‘˜è§’è‰²ï¼ˆ`@SaCheckRole("system_admin")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: å–æ¶ˆæŒ‡å®šç”¨æˆ·çš„ç¤¾å›¢è´Ÿè´£äººèº«ä»½
- **è·¯å¾„å‚æ•°**:
  - `clubId` (Long): ç¤¾å›¢ID
  - `userId` (Long): ç”¨æˆ·ID
- **å“åº”**: å–æ¶ˆæˆåŠŸæç¤º

---

### 2.3 æ´»åŠ¨ç®¡ç†æ¨¡å—

#### 2.3.1 å­¦ç”Ÿç«¯æ¥å£

**æ§åˆ¶å™¨**: `ActivityController`  
**åŸºç¡€è·¯å¾„**: `/activity`  
**åŠŸèƒ½æè¿°**: æä¾›æ´»åŠ¨æµè§ˆã€æŠ¥åã€å–æ¶ˆæŠ¥åç­‰å­¦ç”Ÿç«¯åŠŸèƒ½

##### 2.3.1.1 æµè§ˆæ´»åŠ¨åˆ—è¡¨
- **æ¥å£è·¯å¾„**: `GET /activity/list`
- **æƒé™è¦æ±‚**: å…¬å¼€æ¥å£ï¼ˆæ— éœ€ç™»å½•ï¼‰
- **åŠŸèƒ½è¯´æ˜**: æ”¯æŒå…³é”®è¯æœç´¢å’Œç¤¾å›¢ç­›é€‰çš„æ´»åŠ¨åˆ—è¡¨æŸ¥è¯¢
- **è¯·æ±‚å‚æ•°**:
  - `pageNum` (Integer, é»˜è®¤å€¼: 1): é¡µç 
  - `pageSize` (Integer, é»˜è®¤å€¼: 10): æ¯é¡µæ•°é‡
  - `keyword` (String, å¯é€‰): æœç´¢å…³é”®è¯
  - `clubId` (Long, å¯é€‰): ç¤¾å›¢ID
- **å“åº”**: `Page<ActivityVO>`

##### 2.3.1.2 æŸ¥çœ‹æ´»åŠ¨è¯¦æƒ…
- **æ¥å£è·¯å¾„**: `GET /activity/{id}`
- **æƒé™è¦æ±‚**: å…¬å¼€æ¥å£ï¼ˆæ— éœ€ç™»å½•ï¼‰
- **åŠŸèƒ½è¯´æ˜**: æŸ¥çœ‹æ´»åŠ¨è¯¦ç»†ä¿¡æ¯
- **è·¯å¾„å‚æ•°**: `id` (Long): æ´»åŠ¨ID
- **å“åº”**: `ActivityDetailVO`

##### 2.3.1.3 æŠ¥åæ´»åŠ¨
- **æ¥å£è·¯å¾„**: `POST /activity/{id}/signup`
- **æƒé™è¦æ±‚**: éœ€è¦ç™»å½•ï¼ˆ`@SaCheckRole("user")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: ç”¨æˆ·æŠ¥åå‚åŠ æ´»åŠ¨
- **è·¯å¾„å‚æ•°**: `id` (Long): æ´»åŠ¨ID
- **å“åº”**: æŠ¥åæˆåŠŸæç¤º

##### 2.3.1.4 å–æ¶ˆæŠ¥å
- **æ¥å£è·¯å¾„**: `DELETE /activity/{id}/signup`
- **æƒé™è¦æ±‚**: éœ€è¦ç™»å½•ï¼ˆ`@SaCheckRole("user")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: ç”¨æˆ·å–æ¶ˆæ´»åŠ¨æŠ¥å
- **è·¯å¾„å‚æ•°**: `id` (Long): æ´»åŠ¨ID
- **å“åº”**: å–æ¶ˆæŠ¥åæˆåŠŸæç¤º

##### 2.3.1.5 æŸ¥çœ‹æˆ‘çš„æŠ¥åè®°å½•
- **æ¥å£è·¯å¾„**: `GET /activity/my-signups`
- **æƒé™è¦æ±‚**: éœ€è¦ç™»å½•ï¼ˆ`@SaCheckRole("user")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: æŸ¥çœ‹å½“å‰ç”¨æˆ·çš„æ‰€æœ‰æ´»åŠ¨æŠ¥åè®°å½•
- **å“åº”**: `List<ActivitySignupVO>`

#### 2.3.2 ç¤¾å›¢ç®¡ç†å‘˜æ¥å£

**æ§åˆ¶å™¨**: `ClubActivityController`  
**åŸºç¡€è·¯å¾„**: `/club-admin/activity`  
**åŠŸèƒ½æè¿°**: æä¾›ç¤¾å›¢è´Ÿè´£äººåˆ›å»ºã€ç®¡ç†æ´»åŠ¨ç­‰åŠŸèƒ½

##### 2.3.2.1 åˆ›å»ºæ´»åŠ¨
- **æ¥å£è·¯å¾„**: `POST /club-admin/activity/create`
- **æƒé™è¦æ±‚**: éœ€è¦ç™»å½•ï¼ˆ`@SaCheckRole("user")`ï¼‰ï¼Œå…·ä½“æƒé™åœ¨Serviceå±‚éªŒè¯
- **åŠŸèƒ½è¯´æ˜**: ç¤¾å›¢è´Ÿè´£äººåˆ›å»ºæ´»åŠ¨ï¼Œåˆ›å»ºåç­‰å¾…ç³»ç»Ÿç®¡ç†å‘˜å®¡æ ¸
- **è¯·æ±‚ä½“**: `CreateActivityRequest`
- **å“åº”**: æ´»åŠ¨åˆ›å»ºæˆåŠŸæç¤ºï¼ˆæç¤ºç­‰å¾…å®¡æ ¸ï¼‰

##### 2.3.2.2 æ›´æ–°æ´»åŠ¨
- **æ¥å£è·¯å¾„**: `PUT /club-admin/activity/{id}`
- **æƒé™è¦æ±‚**: éœ€è¦ç™»å½•ï¼ˆ`@SaCheckRole("user")`ï¼‰ï¼Œå…·ä½“æƒé™åœ¨Serviceå±‚éªŒè¯
- **åŠŸèƒ½è¯´æ˜**: ç¤¾å›¢è´Ÿè´£äººæ›´æ–°æ´»åŠ¨ä¿¡æ¯
- **è·¯å¾„å‚æ•°**: `id` (Long): æ´»åŠ¨ID
- **è¯·æ±‚ä½“**: `UpdateActivityRequest`
- **å“åº”**: æ´»åŠ¨æ›´æ–°æˆåŠŸæç¤º

##### 2.3.2.3 å–æ¶ˆæ´»åŠ¨
- **æ¥å£è·¯å¾„**: `PUT /club-admin/activity/{id}/cancel`
- **æƒé™è¦æ±‚**: éœ€è¦ç™»å½•ï¼ˆ`@SaCheckRole("user")`ï¼‰ï¼Œå…·ä½“æƒé™åœ¨Serviceå±‚éªŒè¯
- **åŠŸèƒ½è¯´æ˜**: ç¤¾å›¢è´Ÿè´£äººå–æ¶ˆæ´»åŠ¨
- **è·¯å¾„å‚æ•°**: `id` (Long): æ´»åŠ¨ID
- **å“åº”**: æ´»åŠ¨å·²å–æ¶ˆæç¤º

##### 2.3.2.4 æŸ¥çœ‹æ´»åŠ¨æŠ¥ååˆ—è¡¨
- **æ¥å£è·¯å¾„**: `GET /club-admin/activity/{id}/signups`
- **æƒé™è¦æ±‚**: éœ€è¦ç™»å½•ï¼ˆ`@SaCheckRole("user")`ï¼‰ï¼Œå…·ä½“æƒé™åœ¨Serviceå±‚éªŒè¯
- **åŠŸèƒ½è¯´æ˜**: ç¤¾å›¢è´Ÿè´£äººæŸ¥çœ‹æ´»åŠ¨çš„æ‰€æœ‰æŠ¥åäººå‘˜
- **è·¯å¾„å‚æ•°**: `id` (Long): æ´»åŠ¨ID
- **è¯·æ±‚å‚æ•°**:
  - `pageNum` (Integer, é»˜è®¤å€¼: 1): é¡µç 
  - `pageSize` (Integer, é»˜è®¤å€¼: 10): æ¯é¡µæ•°é‡
- **å“åº”**: `Page<ActivitySignupVO>`

##### 2.3.2.5 æ´»åŠ¨ç­¾åˆ°/æ ‡è®°ç¼ºå¸­
- **æ¥å£è·¯å¾„**: `POST /club-admin/activity/{id}/checkin`
- **æƒé™è¦æ±‚**: éœ€è¦ç™»å½•ï¼ˆ`@SaCheckRole("user")`ï¼‰ï¼Œå…·ä½“æƒé™åœ¨Serviceå±‚éªŒè¯
- **åŠŸèƒ½è¯´æ˜**: ç¤¾å›¢è´Ÿè´£äººä¸ºæŠ¥åç”¨æˆ·ç­¾åˆ°æˆ–æ ‡è®°ç¼ºå¸­
- **è·¯å¾„å‚æ•°**: `id` (Long): æ´»åŠ¨ID
- **è¯·æ±‚ä½“**: `CheckinRequest`
- **å“åº”**: æ“ä½œæˆåŠŸæç¤º

#### 2.3.3 ç³»ç»Ÿç®¡ç†å‘˜æ¥å£

**æ§åˆ¶å™¨**: `AdminActivityController`  
**åŸºç¡€è·¯å¾„**: `/admin/activity`  
**åŠŸèƒ½æè¿°**: æä¾›ç³»ç»Ÿç®¡ç†å‘˜å®¡æ ¸ã€ç®¡ç†æ‰€æœ‰æ´»åŠ¨çš„åŠŸèƒ½

##### 2.3.3.1 æŸ¥çœ‹æ‰€æœ‰æ´»åŠ¨
- **æ¥å£è·¯å¾„**: `GET /admin/activity/list`
- **æƒé™è¦æ±‚**: éœ€è¦ç³»ç»Ÿç®¡ç†å‘˜è§’è‰²ï¼ˆ`@SaCheckRole("system_admin")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: ç³»ç»Ÿç®¡ç†å‘˜æŸ¥çœ‹æ‰€æœ‰æ´»åŠ¨ï¼Œæ”¯æŒå…³é”®è¯å’ŒçŠ¶æ€ç­›é€‰
- **è¯·æ±‚å‚æ•°**:
  - `pageNum` (Integer, é»˜è®¤å€¼: 1): é¡µç 
  - `pageSize` (Integer, é»˜è®¤å€¼: 10): æ¯é¡µæ•°é‡
  - `keyword` (String, å¯é€‰): æœç´¢å…³é”®è¯
  - `status` (String, å¯é€‰): æ´»åŠ¨çŠ¶æ€
- **å“åº”**: `Page<ActivityVO>`

##### 2.3.3.2 å®¡æ ¸æ´»åŠ¨
- **æ¥å£è·¯å¾„**: `PUT /admin/activity/{id}/review`
- **æƒé™è¦æ±‚**: éœ€è¦ç³»ç»Ÿç®¡ç†å‘˜è§’è‰²ï¼ˆ`@SaCheckRole("system_admin")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: ç³»ç»Ÿç®¡ç†å‘˜å®¡æ ¸æ´»åŠ¨ï¼ˆé€šè¿‡/æ‹’ç»ï¼‰
- **è·¯å¾„å‚æ•°**: `id` (Long): æ´»åŠ¨ID
- **è¯·æ±‚ä½“**: `ReviewActivityRequest`
- **å“åº”**: å®¡æ ¸å®Œæˆæç¤º

##### 2.3.3.3 åˆ é™¤æ´»åŠ¨
- **æ¥å£è·¯å¾„**: `DELETE /admin/activity/{id}`
- **æƒé™è¦æ±‚**: éœ€è¦ç³»ç»Ÿç®¡ç†å‘˜è§’è‰²ï¼ˆ`@SaCheckRole("system_admin")`ï¼‰
- **åŠŸèƒ½è¯´æ˜**: ç³»ç»Ÿç®¡ç†å‘˜åˆ é™¤æ´»åŠ¨
- **è·¯å¾„å‚æ•°**: `id` (Long): æ´»åŠ¨ID
- **å“åº”**: åˆ é™¤æˆåŠŸæç¤º

---

## 3. é‡è¦åŠŸèƒ½çš„é¡ºåºå›¾ã€åä½œå›¾ã€çŠ¶æ€å›¾

### 3.1 é¡ºåºå›¾

#### 3.1.1 ç”¨æˆ·ç™»å½•åŠŸèƒ½ - é¡ºåºå›¾

```plantuml
@startuml
actor ç”¨æˆ·
participant UserController
participant UserServiceImpl
participant UserMapper
participant StpUtil
database MySQL

ç”¨æˆ· -> UserController: POST /user/login\n{username, password}
activate UserController

UserController -> UserServiceImpl: login(LoginRequest)
activate UserServiceImpl

UserServiceImpl -> UserServiceImpl: æ„å»ºæŸ¥è¯¢æ¡ä»¶\neq(username)
UserServiceImpl -> UserMapper: selectOne(queryWrapper)
activate UserMapper
UserMapper -> MySQL: SELECT * FROM user\nWHERE username=?
MySQL --> UserMapper: Userå¯¹è±¡
UserMapper --> UserServiceImpl: Userå¯¹è±¡
deactivate UserMapper

alt ç”¨æˆ·ä¸å­˜åœ¨
    UserServiceImpl --> UserController: æŠ›å‡ºBusinessException\n"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"
    UserController --> ç”¨æˆ·: 400 é”™è¯¯å“åº”
else ç”¨æˆ·å­˜åœ¨
    UserServiceImpl -> UserServiceImpl: encryptPassword(password)\nMD5(password+SALT)
    
    alt å¯†ç é”™è¯¯
        UserServiceImpl --> UserController: æŠ›å‡ºBusinessException\n"ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"
        UserController --> ç”¨æˆ·: 400 é”™è¯¯å“åº”
    else å¯†ç æ­£ç¡®
        alt è´¦æˆ·å·²ç¦ç”¨
            UserServiceImpl --> UserController: æŠ›å‡ºBusinessException\n"è´¦æˆ·å·²è¢«ç¦ç”¨"
            UserController --> ç”¨æˆ·: 400 é”™è¯¯å“åº”
        else è´¦æˆ·æ­£å¸¸
            UserServiceImpl -> StpUtil: login(userId)
            activate StpUtil
            StpUtil --> UserServiceImpl: ç™»å½•æˆåŠŸ
            deactivate StpUtil
            
            UserServiceImpl -> StpUtil: getTokenValue()
            activate StpUtil
            StpUtil --> UserServiceImpl: tokenå­—ç¬¦ä¸²
            deactivate StpUtil
            
            UserServiceImpl -> UserServiceImpl: convertToUserInfoVO(user)
            UserServiceImpl --> UserController: LoginResponse\n{token, userInfo}
            deactivate UserServiceImpl
            
            UserController --> ç”¨æˆ·: 200 OK\n{code, message, data}
            deactivate UserController
        end
    end
end

@enduml
```

#### 3.1.2 ç”¨æˆ·æ³¨å†ŒåŠŸèƒ½ - é¡ºåºå›¾

```plantuml
@startuml
actor ç”¨æˆ·
participant UserController
participant UserServiceImpl
participant UserMapper
database MySQL

ç”¨æˆ· -> UserController: POST /user/register\n{username, password, studentId, email...}
activate UserController

UserController -> UserServiceImpl: register(RegisterRequest)
activate UserServiceImpl

UserServiceImpl -> UserMapper: count(usernameæŸ¥è¯¢æ¡ä»¶)
activate UserMapper
UserMapper -> MySQL: SELECT COUNT(*)\nWHERE username=?
MySQL --> UserMapper: count
UserMapper --> UserServiceImpl: count
deactivate UserMapper

alt ç”¨æˆ·åå·²å­˜åœ¨
    UserServiceImpl --> UserController: æŠ›å‡ºBusinessException\n"ç”¨æˆ·åå·²å­˜åœ¨"
    UserController --> ç”¨æˆ·: 400 é”™è¯¯å“åº”
else ç”¨æˆ·åå¯ç”¨
    UserServiceImpl -> UserMapper: count(studentIdæŸ¥è¯¢æ¡ä»¶)
    activate UserMapper
    UserMapper -> MySQL: SELECT COUNT(*)\nWHERE student_id=?
    MySQL --> UserMapper: count
    UserMapper --> UserServiceImpl: count
    deactivate UserMapper
    
    alt å­¦å·å·²å­˜åœ¨
        UserServiceImpl --> UserController: æŠ›å‡ºBusinessException\n"å­¦å·å·²å­˜åœ¨"
        UserController --> ç”¨æˆ·: 400 é”™è¯¯å“åº”
    else å­¦å·å¯ç”¨
        UserServiceImpl -> UserMapper: count(emailæŸ¥è¯¢æ¡ä»¶)
        activate UserMapper
        UserMapper -> MySQL: SELECT COUNT(*)\nWHERE email=?
        MySQL --> UserMapper: count
        UserMapper --> UserServiceImpl: count
        deactivate UserMapper
        
        alt é‚®ç®±å·²å­˜åœ¨
            UserServiceImpl --> UserController: æŠ›å‡ºBusinessException\n"é‚®ç®±å·²å­˜åœ¨"
            UserController --> ç”¨æˆ·: 400 é”™è¯¯å“åº”
        else é‚®ç®±å¯ç”¨
            UserServiceImpl -> UserServiceImpl: åˆ›å»ºUserå¯¹è±¡\nè®¾ç½®role=USER, status=1
            UserServiceImpl -> UserServiceImpl: encryptPassword(password)
            UserServiceImpl -> UserMapper: save(user)
            activate UserMapper
            UserMapper -> MySQL: INSERT INTO user
            MySQL --> UserMapper: æ’å…¥æˆåŠŸ
            UserMapper --> UserServiceImpl: æˆåŠŸ
            deactivate UserMapper
            
            UserServiceImpl --> UserController: æ³¨å†ŒæˆåŠŸ
            deactivate UserServiceImpl
            UserController --> ç”¨æˆ·: 200 OK\n"æ³¨å†ŒæˆåŠŸ"
            deactivate UserController
        end
    end
end

@enduml
```

#### 3.1.3 ç”³è¯·åŠ å…¥ç¤¾å›¢åŠŸèƒ½ - é¡ºåºå›¾

```plantuml
@startuml
actor å­¦ç”Ÿ
participant ClubController
participant ClubServiceImpl
participant ClubMapper
participant ClubMemberMapper
participant ClubApplicationMapper
participant StpUtil
database MySQL

å­¦ç”Ÿ -> ClubController: POST /club/apply\n{clubId, reason}
activate ClubController

ClubController -> StpUtil: getLoginIdAsLong()
activate StpUtil
StpUtil --> ClubController: userId
deactivate StpUtil

ClubController -> ClubServiceImpl: applyJoinClub(request)
activate ClubServiceImpl

ClubServiceImpl -> StpUtil: getLoginIdAsLong()
activate StpUtil
StpUtil --> ClubServiceImpl: userId
deactivate StpUtil

ClubServiceImpl -> ClubMapper: selectById(clubId)
activate ClubMapper
ClubMapper -> MySQL: SELECT * FROM club\nWHERE id=?
MySQL --> ClubMapper: Clubå¯¹è±¡
ClubMapper --> ClubServiceImpl: Clubå¯¹è±¡
deactivate ClubMapper

alt ç¤¾å›¢ä¸å­˜åœ¨
    ClubServiceImpl --> ClubController: æŠ›å‡ºBusinessException\n"ç¤¾å›¢ä¸å­˜åœ¨"
    ClubController --> å­¦ç”Ÿ: 400 é”™è¯¯å“åº”
else ç¤¾å›¢å­˜åœ¨
    alt ç¤¾å›¢çŠ¶æ€!=NORMAL
        ClubServiceImpl --> ClubController: æŠ›å‡ºBusinessException\n"è¯¥ç¤¾å›¢æš‚ä¸å¯åŠ å…¥"
        ClubController --> å­¦ç”Ÿ: 400 é”™è¯¯å“åº”
    else ç¤¾å›¢çŠ¶æ€æ­£å¸¸
        ClubServiceImpl -> ClubMemberMapper: selectCount(clubId+userId)
        activate ClubMemberMapper
        ClubMemberMapper -> MySQL: SELECT COUNT(*)\nWHERE club_id=? AND user_id=?
        MySQL --> ClubMemberMapper: count
        ClubMemberMapper --> ClubServiceImpl: count
        deactivate ClubMemberMapper
        
        alt å·²æ˜¯ç¤¾å›¢æˆå‘˜
            ClubServiceImpl --> ClubController: æŠ›å‡ºBusinessException\n"æ‚¨å·²ç»æ˜¯è¯¥ç¤¾å›¢æˆå‘˜"
            ClubController --> å­¦ç”Ÿ: 400 é”™è¯¯å“åº”
        else ä¸æ˜¯æˆå‘˜
            ClubServiceImpl -> ClubApplicationMapper: selectCount(clubId+userId+PENDING)
            activate ClubApplicationMapper
            ClubApplicationMapper -> MySQL: SELECT COUNT(*)\nWHERE club_id=? AND user_id=?\nAND status='PENDING'
            MySQL --> ClubApplicationMapper: count
            ClubApplicationMapper --> ClubServiceImpl: count
            deactivate ClubApplicationMapper
            
            alt å·²æœ‰å¾…å®¡æ ¸ç”³è¯·
                ClubServiceImpl --> ClubController: æŠ›å‡ºBusinessException\n"æ‚¨å·²æäº¤è¿‡ç”³è¯·ï¼Œè¯·ç­‰å¾…å®¡æ ¸"
                ClubController --> å­¦ç”Ÿ: 400 é”™è¯¯å“åº”
            else å¯ä»¥ç”³è¯·
                ClubServiceImpl -> ClubServiceImpl: åˆ›å»ºClubApplicationå¯¹è±¡\nstatus=PENDING
                ClubServiceImpl -> ClubApplicationMapper: insert(application)
                activate ClubApplicationMapper
                ClubApplicationMapper -> MySQL: INSERT INTO club_application
                MySQL --> ClubApplicationMapper: æ’å…¥æˆåŠŸ
                ClubApplicationMapper --> ClubServiceImpl: æˆåŠŸ
                deactivate ClubApplicationMapper
                
                ClubServiceImpl --> ClubController: ç”³è¯·æäº¤æˆåŠŸ
                deactivate ClubServiceImpl
                ClubController --> å­¦ç”Ÿ: 200 OK\n"ç”³è¯·å·²æäº¤"
                deactivate ClubController
            end
        end
    end
end

@enduml
```

#### 3.1.4 å®¡æ ¸å…¥ç¤¾ç”³è¯·åŠŸèƒ½ - é¡ºåºå›¾

```plantuml
@startuml
actor ç¤¾å›¢è´Ÿè´£äºº
participant ClubManagementController
participant ClubServiceImpl
participant ClubApplicationMapper
participant ClubMemberMapper
participant StpUtil
database MySQL

ç¤¾å›¢è´Ÿè´£äºº -> ClubManagementController: POST /club/management/{clubId}/applications/review\n{applicationId, status, reviewNote}
activate ClubManagementController

ClubManagementController -> StpUtil: getLoginIdAsLong()
activate StpUtil
StpUtil --> ClubManagementController: userId
deactivate StpUtil

ClubManagementController -> ClubServiceImpl: reviewApplicationByLeader(clubId, request)
activate ClubServiceImpl

ClubServiceImpl -> StpUtil: getLoginIdAsLong()
activate StpUtil
StpUtil --> ClubServiceImpl: userId
deactivate StpUtil

ClubServiceImpl -> ClubServiceImpl: verifyClubLeader(clubId, userId)
activate ClubServiceImpl
note right: éªŒè¯æ˜¯å¦ä¸ºç¤¾å›¢è´Ÿè´£äºº
ClubServiceImpl --> ClubServiceImpl: éªŒè¯é€šè¿‡
deactivate ClubServiceImpl

ClubServiceImpl -> ClubApplicationMapper: selectById(applicationId)
activate ClubApplicationMapper
ClubApplicationMapper -> MySQL: SELECT * FROM club_application\nWHERE id=?
MySQL --> ClubApplicationMapper: ClubApplicationå¯¹è±¡
ClubApplicationMapper --> ClubServiceImpl: ClubApplicationå¯¹è±¡
deactivate ClubApplicationMapper

alt ç”³è¯·ä¸å­˜åœ¨
    ClubServiceImpl --> ClubManagementController: æŠ›å‡ºBusinessException\n"ç”³è¯·è®°å½•ä¸å­˜åœ¨"
    ClubManagementController --> ç¤¾å›¢è´Ÿè´£äºº: 400 é”™è¯¯å“åº”
else ç”³è¯·å­˜åœ¨
    alt ç”³è¯·ä¸å±äºè¯¥ç¤¾å›¢
        ClubServiceImpl --> ClubManagementController: æŠ›å‡ºBusinessException\n"æ— æƒå®¡æ ¸å…¶ä»–ç¤¾å›¢çš„ç”³è¯·"
        ClubManagementController --> ç¤¾å›¢è´Ÿè´£äºº: 400 é”™è¯¯å“åº”
    else ç”³è¯·å±äºè¯¥ç¤¾å›¢
        alt ç”³è¯·çŠ¶æ€!=PENDING
            ClubServiceImpl --> ClubManagementController: æŠ›å‡ºBusinessException\n"è¯¥ç”³è¯·å·²è¢«å¤„ç†"
            ClubManagementController --> ç¤¾å›¢è´Ÿè´£äºº: 400 é”™è¯¯å“åº”
        else ç”³è¯·å¾…å®¡æ ¸
            ClubServiceImpl -> ClubServiceImpl: æ›´æ–°ç”³è¯·çŠ¶æ€\nstatus, reviewNote, reviewTime, reviewerId
            ClubServiceImpl -> ClubApplicationMapper: updateById(application)
            activate ClubApplicationMapper
            ClubApplicationMapper -> MySQL: UPDATE club_application\nSET status=?, review_note=?...
            MySQL --> ClubApplicationMapper: æ›´æ–°æˆåŠŸ
            ClubApplicationMapper --> ClubServiceImpl: æˆåŠŸ
            deactivate ClubApplicationMapper
            
            alt status==APPROVED
                ClubServiceImpl -> ClubServiceImpl: åˆ›å»ºClubMemberå¯¹è±¡\nrole=MEMBER
                ClubServiceImpl -> ClubMemberMapper: insert(member)
                activate ClubMemberMapper
                ClubMemberMapper -> MySQL: INSERT INTO club_member
                MySQL --> ClubMemberMapper: æ’å…¥æˆåŠŸ
                ClubMemberMapper --> ClubServiceImpl: æˆåŠŸ
                deactivate ClubMemberMapper
            end
            
            ClubServiceImpl --> ClubManagementController: å®¡æ ¸å®Œæˆ
            deactivate ClubServiceImpl
            ClubManagementController --> ç¤¾å›¢è´Ÿè´£äºº: 200 OK\n"å®¡æ ¸å®Œæˆ"
            deactivate ClubManagementController
        end
    end
end

@enduml
```

#### 3.1.5 åˆ›å»ºæ´»åŠ¨åŠŸèƒ½ - é¡ºåºå›¾

```plantuml
@startuml
actor ç¤¾å›¢è´Ÿè´£äºº
participant ClubActivityController
participant ActivityServiceImpl
participant ClubMapper
participant ActivityMapper
participant StpUtil
database MySQL

ç¤¾å›¢è´Ÿè´£äºº -> ClubActivityController: POST /club-admin/activity/create\n{clubId, title, content, startTime...}
activate ClubActivityController

ClubActivityController -> StpUtil: getLoginIdAsLong()
activate StpUtil
StpUtil --> ClubActivityController: userId
deactivate StpUtil

ClubActivityController -> ActivityServiceImpl: createActivity(request)
activate ActivityServiceImpl

ActivityServiceImpl -> StpUtil: getLoginIdAsLong()
activate StpUtil
StpUtil --> ActivityServiceImpl: userId
deactivate StpUtil

ActivityServiceImpl -> ClubMapper: selectById(clubId)
activate ClubMapper
ClubMapper -> MySQL: SELECT * FROM club\nWHERE id=?
MySQL --> ClubMapper: Clubå¯¹è±¡
ClubMapper --> ActivityServiceImpl: Clubå¯¹è±¡
deactivate ClubMapper

alt ç¤¾å›¢ä¸å­˜åœ¨
    ActivityServiceImpl --> ClubActivityController: æŠ›å‡ºBusinessException\n"ç¤¾å›¢ä¸å­˜åœ¨"
    ClubActivityController --> ç¤¾å›¢è´Ÿè´£äºº: 400 é”™è¯¯å“åº”
else ç¤¾å›¢å­˜åœ¨
    ActivityServiceImpl -> ActivityServiceImpl: verifyClubLeader(clubId, userId)
    activate ActivityServiceImpl
    note right: éªŒè¯æ˜¯å¦ä¸ºç¤¾å›¢è´Ÿè´£äºº
    ActivityServiceImpl --> ActivityServiceImpl: éªŒè¯é€šè¿‡
    deactivate ActivityServiceImpl
    
    alt ç»“æŸæ—¶é—´æ—©äºå¼€å§‹æ—¶é—´
        ActivityServiceImpl --> ClubActivityController: æŠ›å‡ºBusinessException\n"æ´»åŠ¨ç»“æŸæ—¶é—´ä¸èƒ½æ—©äºå¼€å§‹æ—¶é—´"
        ClubActivityController --> ç¤¾å›¢è´Ÿè´£äºº: 400 é”™è¯¯å“åº”
    else æ—¶é—´åˆæ³•
        alt æŠ¥åæˆªæ­¢æ—¶é—´æ—©äºæŠ¥åå¼€å§‹æ—¶é—´
            ActivityServiceImpl --> ClubActivityController: æŠ›å‡ºBusinessException\n"æŠ¥åæˆªæ­¢æ—¶é—´ä¸èƒ½æ—©äºæŠ¥åå¼€å§‹æ—¶é—´"
            ClubActivityController --> ç¤¾å›¢è´Ÿè´£äºº: 400 é”™è¯¯å“åº”
        else æŠ¥åæ—¶é—´åˆæ³•
            ActivityServiceImpl -> ActivityServiceImpl: åˆ›å»ºActivityå¯¹è±¡\nstatus=PENDING\ncurrentMembers=0
            ActivityServiceImpl -> ActivityMapper: save(activity)
            activate ActivityMapper
            ActivityMapper -> MySQL: INSERT INTO activity
            MySQL --> ActivityMapper: æ’å…¥æˆåŠŸ
            ActivityMapper --> ActivityServiceImpl: æˆåŠŸ
            deactivate ActivityMapper
            
            ActivityServiceImpl --> ClubActivityController: æ´»åŠ¨åˆ›å»ºæˆåŠŸ
            deactivate ActivityServiceImpl
            ClubActivityController --> ç¤¾å›¢è´Ÿè´£äºº: 200 OK\n"æ´»åŠ¨åˆ›å»ºæˆåŠŸï¼Œç­‰å¾…å®¡æ ¸"
            deactivate ClubActivityController
        end
    end
end

@enduml
```

#### 3.1.6 æ´»åŠ¨æŠ¥ååŠŸèƒ½ - é¡ºåºå›¾

```plantuml
@startuml
actor å­¦ç”Ÿ
participant ActivityController
participant ActivityServiceImpl
participant ActivityMapper
participant ActivitySignupMapper
participant StpUtil
database MySQL

å­¦ç”Ÿ -> ActivityController: POST /activity/{id}/signup
activate ActivityController

ActivityController -> StpUtil: getLoginIdAsLong()
activate StpUtil
StpUtil --> ActivityController: userId
deactivate StpUtil

ActivityController -> ActivityServiceImpl: signupActivity(activityId)
activate ActivityServiceImpl

ActivityServiceImpl -> StpUtil: getLoginIdAsLong()
activate StpUtil
StpUtil --> ActivityServiceImpl: userId
deactivate StpUtil

ActivityServiceImpl -> ActivityMapper: getById(activityId)
activate ActivityMapper
ActivityMapper -> MySQL: SELECT * FROM activity\nWHERE id=?
MySQL --> ActivityMapper: Activityå¯¹è±¡
ActivityMapper --> ActivityServiceImpl: Activityå¯¹è±¡
deactivate ActivityMapper

alt æ´»åŠ¨ä¸å­˜åœ¨
    ActivityServiceImpl --> ActivityController: æŠ›å‡ºBusinessException\n"æ´»åŠ¨ä¸å­˜åœ¨"
    ActivityController --> å­¦ç”Ÿ: 400 é”™è¯¯å“åº”
else æ´»åŠ¨å­˜åœ¨
    alt æ´»åŠ¨çŠ¶æ€!=PUBLISHED
        ActivityServiceImpl --> ActivityController: æŠ›å‡ºBusinessException\n"è¯¥æ´»åŠ¨ä¸å¯æŠ¥å"
        ActivityController --> å­¦ç”Ÿ: 400 é”™è¯¯å“åº”
    else æ´»åŠ¨å·²å‘å¸ƒ
        ActivityServiceImpl -> ActivityServiceImpl: è·å–å½“å‰æ—¶é—´now
        
        alt æŠ¥åæœªå¼€å§‹
            ActivityServiceImpl --> ActivityController: æŠ›å‡ºBusinessException\n"æŠ¥åå°šæœªå¼€å§‹"
            ActivityController --> å­¦ç”Ÿ: 400 é”™è¯¯å“åº”
        else æŠ¥åå·²æˆªæ­¢
            ActivityServiceImpl --> ActivityController: æŠ›å‡ºBusinessException\n"æŠ¥åå·²æˆªæ­¢"
            ActivityController --> å­¦ç”Ÿ: 400 é”™è¯¯å“åº”
        else æŠ¥åæ—¶é—´å†…
            ActivityServiceImpl -> ActivitySignupMapper: selectOne(activityId+userId)
            activate ActivitySignupMapper
            ActivitySignupMapper -> MySQL: SELECT * FROM activity_signup\nWHERE activity_id=? AND user_id=?
            MySQL --> ActivitySignupMapper: ActivitySignupå¯¹è±¡æˆ–null
            ActivitySignupMapper --> ActivityServiceImpl: existingSignup
            deactivate ActivitySignupMapper
            
            alt å·²æŠ¥å(status=REGISTERED)
                ActivityServiceImpl --> ActivityController: æŠ›å‡ºBusinessException\n"æ‚¨å·²æŠ¥åè¯¥æ´»åŠ¨"
                ActivityController --> å­¦ç”Ÿ: 400 é”™è¯¯å“åº”
            else æ›¾å–æ¶ˆæŠ¥å(status=CANCELLED)
                ActivityServiceImpl -> ActivityServiceImpl: æ›´æ–°æŠ¥åè®°å½•\nstatus=REGISTERED
                ActivityServiceImpl -> ActivitySignupMapper: updateById(signup)
                activate ActivitySignupMapper
                ActivitySignupMapper -> MySQL: UPDATE activity_signup\nSET status='REGISTERED'
                MySQL --> ActivitySignupMapper: æ›´æ–°æˆåŠŸ
                ActivitySignupMapper --> ActivityServiceImpl: æˆåŠŸ
                deactivate ActivitySignupMapper
                
                ActivityServiceImpl -> ActivityServiceImpl: currentMembers++
                ActivityServiceImpl -> ActivityMapper: updateById(activity)
                activate ActivityMapper
                ActivityMapper -> MySQL: UPDATE activity\nSET current_members=?
                MySQL --> ActivityMapper: æ›´æ–°æˆåŠŸ
                ActivityMapper --> ActivityServiceImpl: æˆåŠŸ
                deactivate ActivityMapper
                
                ActivityServiceImpl --> ActivityController: æŠ¥åæˆåŠŸ
                deactivate ActivityServiceImpl
                ActivityController --> å­¦ç”Ÿ: 200 OK\n"æŠ¥åæˆåŠŸ"
                deactivate ActivityController
            else æœªæŠ¥åè¿‡
                alt äººæ•°å·²æ»¡
                    ActivityServiceImpl --> ActivityController: æŠ›å‡ºBusinessException\n"æ´»åŠ¨æŠ¥åäººæ•°å·²æ»¡"
                    ActivityController --> å­¦ç”Ÿ: 400 é”™è¯¯å“åº”
                else äººæ•°æœªæ»¡
                    ActivityServiceImpl -> ActivityServiceImpl: åˆ›å»ºActivitySignupå¯¹è±¡\nstatus=REGISTERED
                    ActivityServiceImpl -> ActivitySignupMapper: insert(signup)
                    activate ActivitySignupMapper
                    ActivitySignupMapper -> MySQL: INSERT INTO activity_signup
                    MySQL --> ActivitySignupMapper: æ’å…¥æˆåŠŸ
                    ActivitySignupMapper --> ActivityServiceImpl: æˆåŠŸ
                    deactivate ActivitySignupMapper
                    
                    ActivityServiceImpl -> ActivityServiceImpl: currentMembers++
                    ActivityServiceImpl -> ActivityMapper: updateById(activity)
                    activate ActivityMapper
                    ActivityMapper -> MySQL: UPDATE activity\nSET current_members=?
                    MySQL --> ActivityMapper: æ›´æ–°æˆåŠŸ
                    ActivityMapper --> ActivityServiceImpl: æˆåŠŸ
                    deactivate ActivityMapper
                    
                    ActivityServiceImpl --> ActivityController: æŠ¥åæˆåŠŸ
                    deactivate ActivityServiceImpl
                    ActivityController --> å­¦ç”Ÿ: 200 OK\n"æŠ¥åæˆåŠŸ"
                    deactivate ActivityController
                end
            end
        end
    end
end

@enduml
```

### 3.2 åä½œå›¾

#### 3.2.1 ç¤¾å›¢ç”³è¯·å®¡æ ¸æµç¨‹ - åä½œå›¾

```plantuml
@startuml
object "1:å­¦ç”Ÿ" as Student
object "2:ClubController" as Controller
object "3:ClubServiceImpl" as Service
object "4:ClubApplicationMapper" as AppMapper
object "5:ClubMemberMapper" as MemberMapper
object "6:MySQLæ•°æ®åº“" as DB

Student -> Controller : 1.1: POST /club/apply\n{clubId, reason}
Controller -> Service : 1.2: applyJoinClub(request)
Service -> Service : 1.3: éªŒè¯ç¤¾å›¢å­˜åœ¨æ€§å’ŒçŠ¶æ€
Service -> AppMapper : 1.4: æ£€æŸ¥æ˜¯å¦å·²ç”³è¯·
AppMapper -> DB : 1.5: SELECT COUNT(*)
DB --> AppMapper : 1.6: count=0
AppMapper --> Service : 1.7: æœªç”³è¯·
Service -> AppMapper : 1.8: insert(application)
AppMapper -> DB : 1.9: INSERT INTO club_application
DB --> AppMapper : 1.10: æ’å…¥æˆåŠŸ
AppMapper --> Service : 1.11: æˆåŠŸ
Service --> Controller : 1.12: ç”³è¯·æäº¤æˆåŠŸ
Controller --> Student : 1.13: 200 OK

note right of Service
  åä½œå…³ç³»ï¼š
  - å­¦ç”Ÿé€šè¿‡Controlleræäº¤ç”³è¯·
  - Serviceåè°ƒä¸šåŠ¡é€»è¾‘éªŒè¯
  - AppMapperè´Ÿè´£æ•°æ®æŒä¹…åŒ–
  - æœ€ç»ˆç»“æœè¿”å›ç»™å­¦ç”Ÿ
end note

object "2.1:ç¤¾å›¢è´Ÿè´£äºº" as Leader
object "2.2:ClubManagementController" as MgmtController

Leader -> MgmtController : 2.1: POST /club/management/{clubId}/applications/review
MgmtController -> Service : 2.2: reviewApplicationByLeader(clubId, request)
Service -> Service : 2.3: verifyClubLeader(clubId, userId)
Service -> AppMapper : 2.4: selectById(applicationId)
AppMapper -> DB : 2.5: SELECT * FROM club_application
DB --> AppMapper : 2.6: ClubApplicationå¯¹è±¡
AppMapper --> Service : 2.7: application
Service -> AppMapper : 2.8: updateById(application)\nè®¾ç½®status=APPROVED
AppMapper -> DB : 2.9: UPDATE club_application
DB --> AppMapper : 2.10: æ›´æ–°æˆåŠŸ
Service -> MemberMapper : 2.11: insert(member)\næ·»åŠ ä¸ºç¤¾å›¢æˆå‘˜
MemberMapper -> DB : 2.12: INSERT INTO club_member
DB --> MemberMapper : 2.13: æ’å…¥æˆåŠŸ
MemberMapper --> Service : 2.14: æˆåŠŸ
Service --> MgmtController : 2.15: å®¡æ ¸å®Œæˆ
MgmtController --> Leader : 2.16: 200 OK

@enduml
```

#### 3.2.2 æ´»åŠ¨æŠ¥åæµç¨‹ - åä½œå›¾

```plantuml
@startuml
object "1:å­¦ç”Ÿ" as Student
object "2:ActivityController" as Controller
object "3:ActivityServiceImpl" as Service
object "4:ActivityMapper" as ActMapper
object "5:ActivitySignupMapper" as SignupMapper
object "6:MySQLæ•°æ®åº“" as DB

Student -> Controller : 1.1: POST /activity/{id}/signup
Controller -> Service : 1.2: signupActivity(activityId)
Service -> ActMapper : 1.3: getById(activityId)
ActMapper -> DB : 1.4: SELECT * FROM activity
DB --> ActMapper : 1.5: Activityå¯¹è±¡
ActMapper --> Service : 1.6: activity
Service -> Service : 1.7: éªŒè¯æ´»åŠ¨çŠ¶æ€ã€æŠ¥åæ—¶é—´ã€äººæ•°é™åˆ¶
Service -> SignupMapper : 1.8: selectOne(activityId+userId)
SignupMapper -> DB : 1.9: SELECT * FROM activity_signup
DB --> SignupMapper : 1.10: null(æœªæŠ¥å)
SignupMapper --> Service : 1.11: null
Service -> SignupMapper : 1.12: insert(signup)\nstatus=REGISTERED
SignupMapper -> DB : 1.13: INSERT INTO activity_signup
DB --> SignupMapper : 1.14: æ’å…¥æˆåŠŸ
SignupMapper --> Service : 1.15: æˆåŠŸ
Service -> ActMapper : 1.16: updateById(activity)\ncurrentMembers++
ActMapper -> DB : 1.17: UPDATE activity
DB --> ActMapper : 1.18: æ›´æ–°æˆåŠŸ
ActMapper --> Service : 1.19: æˆåŠŸ
Service --> Controller : 1.20: æŠ¥åæˆåŠŸ
Controller --> Student : 1.21: 200 OK

note right of Service
  åä½œå…³ç³»ï¼š
  - å­¦ç”Ÿå‘èµ·æŠ¥åè¯·æ±‚
  - ServiceéªŒè¯æ´»åŠ¨çŠ¶æ€å’ŒæŠ¥åæ¡ä»¶
  - SignupMapperåˆ›å»ºæŠ¥åè®°å½•
  - ActMapperæ›´æ–°æ´»åŠ¨æŠ¥åäººæ•°
  - äº‹åŠ¡ä¿è¯æ•°æ®ä¸€è‡´æ€§
end note

@enduml
```

### 3.3 çŠ¶æ€å›¾

#### 3.3.1 ç¤¾å›¢çŠ¶æ€æµè½¬ - çŠ¶æ€å›¾

```plantuml
@startuml
[*] --> NORMAL : ç³»ç»Ÿç®¡ç†å‘˜åˆ›å»ºç¤¾å›¢
[*] --> PENDING : ç”¨æˆ·ç”³è¯·åˆ›å»ºç¤¾å›¢

PENDING --> NORMAL : ç³»ç»Ÿç®¡ç†å‘˜å®¡æ ¸é€šè¿‡
PENDING --> DISABLED : ç³»ç»Ÿç®¡ç†å‘˜å®¡æ ¸æ‹’ç»

NORMAL --> DISABLED : ç³»ç»Ÿç®¡ç†å‘˜ç¦ç”¨ç¤¾å›¢
DISABLED --> NORMAL : ç³»ç»Ÿç®¡ç†å‘˜å¯ç”¨ç¤¾å›¢

NORMAL --> [*] : ç³»ç»Ÿç®¡ç†å‘˜åˆ é™¤ç¤¾å›¢\n(é€»è¾‘åˆ é™¤)
DISABLED --> [*] : ç³»ç»Ÿç®¡ç†å‘˜åˆ é™¤ç¤¾å›¢\n(é€»è¾‘åˆ é™¤)

note right of NORMAL
  æ­£å¸¸çŠ¶æ€ï¼š
  - å¯ä»¥è¢«ç”¨æˆ·æµè§ˆ
  - å¯ä»¥æ¥å—å…¥ç¤¾ç”³è¯·
  - å¯ä»¥åˆ›å»ºæ´»åŠ¨
  - ç¤¾å›¢è´Ÿè´£äººå¯ç®¡ç†
end note

note right of DISABLED
  ç¦ç”¨çŠ¶æ€ï¼š
  - ä¸å¯è¢«ç”¨æˆ·æµè§ˆ
  - ä¸å¯æ¥å—å…¥ç¤¾ç”³è¯·
  - ä¸å¯åˆ›å»ºæ´»åŠ¨
end note

note right of PENDING
  å¾…å®¡æ ¸çŠ¶æ€ï¼š
  - ç”¨æˆ·åˆ›å»ºç¤¾å›¢åçš„åˆå§‹çŠ¶æ€
  - ç­‰å¾…ç³»ç»Ÿç®¡ç†å‘˜å®¡æ ¸
  - ä¸å¯è¢«å…¶ä»–ç”¨æˆ·æµè§ˆ
end note

@enduml
```

#### 3.3.2 å…¥ç¤¾ç”³è¯·çŠ¶æ€æµè½¬ - çŠ¶æ€å›¾

```plantuml
@startuml
[*] --> PENDING : å­¦ç”Ÿæäº¤å…¥ç¤¾ç”³è¯·

PENDING --> APPROVED : ç¤¾å›¢è´Ÿè´£äºº/ç³»ç»Ÿç®¡ç†å‘˜\nå®¡æ ¸é€šè¿‡
PENDING --> REJECTED : ç¤¾å›¢è´Ÿè´£äºº/ç³»ç»Ÿç®¡ç†å‘˜\nå®¡æ ¸æ‹’ç»

APPROVED --> [*] : æµç¨‹ç»“æŸ\n(ç”¨æˆ·å·²æˆä¸ºç¤¾å›¢æˆå‘˜)
REJECTED --> [*] : æµç¨‹ç»“æŸ

note right of PENDING
  å¾…å®¡æ ¸çŠ¶æ€ï¼š
  - ç”³è¯·å·²æäº¤
  - ç­‰å¾…å®¡æ ¸
  - åŒä¸€ç”¨æˆ·å¯¹åŒä¸€ç¤¾å›¢
    åªèƒ½æœ‰ä¸€ä¸ªPENDINGç”³è¯·
end note

note right of APPROVED
  å®¡æ ¸é€šè¿‡ï¼š
  - è‡ªåŠ¨åˆ›å»ºClubMemberè®°å½•
  - role=MEMBER
  - ç”¨æˆ·æˆä¸ºç¤¾å›¢æ™®é€šæˆå‘˜
  - è®°å½•å®¡æ ¸äººã€å®¡æ ¸æ—¶é—´ã€å®¡æ ¸å¤‡æ³¨
end note

note right of REJECTED
  å®¡æ ¸æ‹’ç»ï¼š
  - ä¸åˆ›å»ºæˆå‘˜è®°å½•
  - è®°å½•å®¡æ ¸äººã€å®¡æ ¸æ—¶é—´ã€å®¡æ ¸å¤‡æ³¨
  - ç”¨æˆ·å¯é‡æ–°ç”³è¯·
end note

@enduml
```

#### 3.3.3 æ´»åŠ¨çŠ¶æ€æµè½¬ - çŠ¶æ€å›¾

```plantuml
@startuml
[*] --> DRAFT : ç¤¾å›¢è´Ÿè´£äººåˆ›å»ºæ´»åŠ¨\n(ä¿å­˜è‰ç¨¿)
[*] --> PENDING : ç¤¾å›¢è´Ÿè´£äººåˆ›å»ºæ´»åŠ¨\n(æäº¤å®¡æ ¸)

DRAFT --> PENDING : ç¤¾å›¢è´Ÿè´£äººæäº¤å®¡æ ¸
DRAFT --> [*] : ç¤¾å›¢è´Ÿè´£äººåˆ é™¤è‰ç¨¿

PENDING --> PUBLISHED : ç³»ç»Ÿç®¡ç†å‘˜å®¡æ ¸é€šè¿‡
PENDING --> CANCELLED : ç³»ç»Ÿç®¡ç†å‘˜å®¡æ ¸æ‹’ç»
PENDING --> CANCELLED : ç¤¾å›¢è´Ÿè´£äººå–æ¶ˆæ´»åŠ¨

PUBLISHED --> CANCELLED : ç¤¾å›¢è´Ÿè´£äººå–æ¶ˆæ´»åŠ¨
PUBLISHED --> COMPLETED : æ´»åŠ¨ç»“æŸæ—¶é—´åˆ°è¾¾

COMPLETED --> [*] : æ´»åŠ¨å½’æ¡£

CANCELLED --> [*] : æ´»åŠ¨å½’æ¡£

note right of DRAFT
  è‰ç¨¿çŠ¶æ€ï¼š
  - æ´»åŠ¨ä¿¡æ¯æœªå®Œå–„
  - ä»…åˆ›å»ºè€…å¯è§
  - å¯ä»¥ä¿®æ”¹
  - å¯ä»¥åˆ é™¤
end note

note right of PENDING
  å¾…å®¡æ ¸çŠ¶æ€ï¼š
  - ç­‰å¾…ç³»ç»Ÿç®¡ç†å‘˜å®¡æ ¸
  - ä¸å¯æŠ¥å
  - å¯ä»¥ä¿®æ”¹
  - å¯ä»¥å–æ¶ˆ
end note

note right of PUBLISHED
  å·²å‘å¸ƒçŠ¶æ€ï¼š
  - å®¡æ ¸é€šè¿‡
  - ç”¨æˆ·å¯æµè§ˆå’ŒæŠ¥å
  - ä¸å¯ä¿®æ”¹
  - å¯ä»¥å–æ¶ˆ
  - ç¤¾å›¢è´Ÿè´£äººå¯ç®¡ç†æŠ¥å
end note

note right of COMPLETED
  å·²å®ŒæˆçŠ¶æ€ï¼š
  - æ´»åŠ¨å·²ç»“æŸ
  - ä¸å¯æŠ¥å
  - ä¸å¯å–æ¶ˆ
  - å¯æŸ¥çœ‹å†å²è®°å½•
end note

note right of CANCELLED
  å·²å–æ¶ˆçŠ¶æ€ï¼š
  - æ´»åŠ¨è¢«å–æ¶ˆæˆ–å®¡æ ¸æ‹’ç»
  - æ‰€æœ‰æŠ¥åè®°å½•è‡ªåŠ¨å–æ¶ˆ
  - ä¸å¯æ¢å¤
end note

@enduml
```

#### 3.3.4 æ´»åŠ¨æŠ¥åçŠ¶æ€æµè½¬ - çŠ¶æ€å›¾

```plantuml
@startuml
[*] --> REGISTERED : å­¦ç”ŸæŠ¥åæ´»åŠ¨

REGISTERED --> CANCELLED : å­¦ç”Ÿå–æ¶ˆæŠ¥å\n(æ´»åŠ¨å¼€å§‹å‰)
REGISTERED --> CHECKED_IN : ç¤¾å›¢è´Ÿè´£äººç­¾åˆ°
REGISTERED --> ABSENT : ç¤¾å›¢è´Ÿè´£äººæ ‡è®°ç¼ºå¸­

CANCELLED --> REGISTERED : å­¦ç”Ÿé‡æ–°æŠ¥å

CHECKED_IN --> [*] : æ´»åŠ¨ç»“æŸ
ABSENT --> [*] : æ´»åŠ¨ç»“æŸ
CANCELLED --> [*] : æ´»åŠ¨ç»“æŸæˆ–å–æ¶ˆ

note right of REGISTERED
  å·²æŠ¥åçŠ¶æ€ï¼š
  - æŠ¥åæˆåŠŸ
  - æ´»åŠ¨currentMembers+1
  - æ´»åŠ¨å¼€å§‹å‰å¯å–æ¶ˆ
  - ç­‰å¾…æ´»åŠ¨å¼€å§‹
end note

note right of CANCELLED
  å·²å–æ¶ˆçŠ¶æ€ï¼š
  - ç”¨æˆ·ä¸»åŠ¨å–æ¶ˆ
  - æˆ–æ´»åŠ¨è¢«å–æ¶ˆå¯¼è‡´
  - æ´»åŠ¨currentMembers-1
  - å¯ä»¥é‡æ–°æŠ¥å
end note

note right of CHECKED_IN
  å·²ç­¾åˆ°çŠ¶æ€ï¼š
  - ç¤¾å›¢è´Ÿè´£äººç¡®è®¤ç­¾åˆ°
  - è®°å½•ç­¾åˆ°æ—¶é—´
  - ä¸å¯å–æ¶ˆ
  - è¡¨ç¤ºç”¨æˆ·å‚åŠ äº†æ´»åŠ¨
end note

note right of ABSENT
  ç¼ºå¸­çŠ¶æ€ï¼š
  - ç¤¾å›¢è´Ÿè´£äººæ ‡è®°ç¼ºå¸­
  - ç”¨æˆ·æœªå‚åŠ æ´»åŠ¨
  - ä¸å¯å–æ¶ˆ
  - å¯èƒ½å½±å“ä¿¡ç”¨è®°å½•
end note

@enduml
```

#### 3.2.3 æƒé™éªŒè¯æµç¨‹ - åä½œå›¾

```plantuml
@startuml
object "1:ç”¨æˆ·è¯·æ±‚" as Request
object "2:SaTokenInterceptor" as Interceptor
object "3:Controller" as Controller
object "4:StpUtil" as StpUtil
object "5:ServiceImpl" as Service
object "6:ClubMemberMapper" as Mapper
object "7:MySQLæ•°æ®åº“" as DB

Request -> Interceptor : 1.1: HTTPè¯·æ±‚\nHeader: Authorization=token
Interceptor -> StpUtil : 1.2: checkLogin()\néªŒè¯tokenæœ‰æ•ˆæ€§
StpUtil --> Interceptor : 1.3: tokenæœ‰æ•ˆ
Interceptor -> StpUtil : 1.4: checkRole("user")\néªŒè¯ç”¨æˆ·è§’è‰²
StpUtil --> Interceptor : 1.5: è§’è‰²éªŒè¯é€šè¿‡
Interceptor -> Controller : 1.6: æ”¾è¡Œè¯·æ±‚
Controller -> Service : 1.7: è°ƒç”¨ä¸šåŠ¡æ–¹æ³•
Service -> Service : 1.8: verifyClubLeader(clubId, userId)
Service -> Mapper : 1.9: æŸ¥è¯¢ç”¨æˆ·æ˜¯å¦ä¸ºç¤¾å›¢è´Ÿè´£äºº
Mapper -> DB : 1.10: SELECT * FROM club_member
DB --> Mapper : 1.11: æŸ¥è¯¢ç»“æœ
Mapper --> Service : 1.12: è¿”å›æˆå‘˜ä¿¡æ¯
Service -> Service : 1.13: éªŒè¯role=leader
Service --> Controller : 1.14: æƒé™éªŒè¯é€šè¿‡ï¼Œæ‰§è¡Œä¸šåŠ¡é€»è¾‘
Controller --> Request : 1.15: è¿”å›å“åº”ç»“æœ

note right of Service
  æƒé™éªŒè¯å±‚æ¬¡ï¼š
  1. TokenéªŒè¯ï¼ˆæ‹¦æˆªå™¨å±‚ï¼‰
  2. è§’è‰²éªŒè¯ï¼ˆæ³¨è§£å±‚ï¼‰
  3. ä¸šåŠ¡æƒé™éªŒè¯ï¼ˆServiceå±‚ï¼‰
end note

@enduml
```





















